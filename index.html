<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitTracker Pro - Sistema Avan√ßado de Treinos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4B4BBE',
                        'primary-light': '#7B7AE8',
                        secondary: '#FF6B6B',
                        accent: '#4ECDC4',
                        success: '#45B7D1',
                        warning: '#FFA726',
                        dark: '#2D3748'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif']
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'pulse-slow': 'pulse 3s infinite',
                        'fade-in': 'fadeIn 0.6s ease-in-out',
                        'slide-up': 'slideUp 0.4s ease-out',
                        'slide-in': 'slideIn 0.5s ease-out',
                        'scale-in': 'scaleIn 0.3s ease-out',
                        'glow': 'glow 2s ease-in-out infinite alternate'
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                        'gradient-conic': 'conic-gradient(from 180deg at 50% 50%, var(--tw-gradient-stops))',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(93, 92, 222, 0.3); }
            to { box-shadow: 0 0 30px rgba(93, 92, 222, 0.6); }
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark .glass-effect {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .neo-morphism {
            background: linear-gradient(145deg, #ffffff, #e6e6e6);
            box-shadow: 20px 20px 60px #d9d9d9, -20px -20px 60px #ffffff;
        }
        .dark .neo-morphism {
            background: linear-gradient(145deg, #2d3748, #1a202c);
            box-shadow: 20px 20px 60px #1a202c, -20px -20px 60px #2d3748;
        }
        .workout-glow {
            animation: glow 2s ease-in-out infinite alternate;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #5D5CDE;
            border-radius: 10px;
        }
        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 text-gray-900 dark:text-white transition-all duration-700 font-sans custom-scrollbar">
    
    <!-- Enhanced Header with Stats -->
    <header class="bg-gradient-to-r from-primary via-primary-dark to-purple-600 text-white shadow-2xl relative overflow-hidden">
        <div class="absolute inset-0 bg-black opacity-10"></div>
        <div class="container mx-auto px-4 py-6 relative">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full">
                        <i class="fas fa-dumbbell text-3xl"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-black">FitTracker Pro</h1>
                        <p class="text-blue-100 text-sm">Sistema Avan√ßado de Treinos</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-center">
                        <div class="text-2xl font-bold" id="headerLevel">N√≠vel 1</div>
                        <div class="text-xs text-blue-200">Iniciante</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold" id="headerStreak">0</div>
                        <div class="text-xs text-blue-200">Dias seguidos</div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm" id="currentDate"></div>
                        <div class="text-xs text-blue-200" id="currentTime"></div>
                    </div>
                    <button id="darkModeToggle" class="bg-white bg-opacity-20 hover:bg-opacity-30 p-2 rounded-full transition-all">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Enhanced Navigation with Icons and Badges -->
    <nav class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-lg sticky top-0 z-40 backdrop-blur-sm">
        <div class="container mx-auto px-4">
            <div class="flex space-x-8 overflow-x-auto">
                <button class="nav-btn active py-4 px-4 border-b-3 border-primary text-primary font-semibold whitespace-nowrap" data-tab="dashboard">
                    <i class="fas fa-chart-line mr-2"></i>Dashboard
                    <span class="ml-1 bg-primary text-white text-xs px-2 py-1 rounded-full" id="dashboardBadge">0</span>
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="workout">
                    <i class="fas fa-plus mr-2"></i>Novo Treino
                    <span class="ml-1 bg-green-500 text-white text-xs px-2 py-1 rounded-full pulse" id="workoutBadge">!</span>
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="exercises">
                    <i class="fas fa-list mr-2"></i>Exerc√≠cios
                    <span class="ml-1 bg-blue-500 text-white text-xs px-2 py-1 rounded-full" id="exercisesBadge">28</span>
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="analytics">
                    <i class="fas fa-chart-bar mr-2"></i>An√°lises
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="goals">
                    <i class="fas fa-target mr-2"></i>Metas
                    <span class="ml-1 bg-orange-500 text-white text-xs px-2 py-1 rounded-full" id="goalsBadge">3</span>
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="tools">
                    <i class="fas fa-tools mr-2"></i>Ferramentas
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="progress">
                    <i class="fas fa-trophy mr-2"></i>Progresso
                </button>
                <button class="nav-btn py-4 px-4 border-b-3 border-transparent hover:border-gray-300 transition-all whitespace-nowrap" data-tab="history">
                    <i class="fas fa-history mr-2"></i>Hist√≥rico
                </button>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-6">
        <!-- Enhanced Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <!-- Quick Stats with Animations -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="neo-morphism bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white hover:scale-105 transition-transform cursor-pointer animate-fade-in">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm font-medium">Treinos Esta Semana</p>
                            <p class="text-4xl font-black" id="weeklyWorkouts">0</p>
                            <div class="flex items-center mt-2">
                                <i class="fas fa-arrow-up text-green-300 text-xs"></i>
                                <span class="text-green-300 text-xs ml-1" id="weeklyChange">+0%</span>
                            </div>
                        </div>
                        <div class="bg-white bg-opacity-20 p-4 rounded-full">
                            <i class="fas fa-calendar-week text-3xl"></i>
                        </div>
                    </div>
                </div>
                
                <div class="neo-morphism bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-6 text-white hover:scale-105 transition-transform cursor-pointer animate-fade-in" style="animation-delay: 0.1s">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm font-medium">Volume Total</p>
                            <p class="text-4xl font-black" id="totalVolume">0<span class="text-xl">kg</span></p>
                            <div class="flex items-center mt-2">
                                <i class="fas fa-fire text-orange-300 text-xs"></i>
                                <span class="text-orange-300 text-xs ml-1" id="volumeStreak">Recorde!</span>
                            </div>
                        </div>
                        <div class="bg-white bg-opacity-20 p-4 rounded-full">
                            <i class="fas fa-weight-hanging text-3xl"></i>
                        </div>
                    </div>
                </div>
                
                <div class="neo-morphism bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl p-6 text-white hover:scale-105 transition-transform cursor-pointer animate-fade-in" style="animation-delay: 0.2s">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm font-medium">For√ßa Estimada</p>
                            <p class="text-4xl font-black" id="strengthScore">0</p>
                            <div class="flex items-center mt-2">
                                <div class="flex text-yellow-300 text-xs">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <i class="far fa-star"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white bg-opacity-20 p-4 rounded-full">
                            <i class="fas fa-fist-raised text-3xl"></i>
                        </div>
                    </div>
                </div>
                
                <div class="neo-morphism bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl p-6 text-white hover:scale-105 transition-transform cursor-pointer animate-fade-in" style="animation-delay: 0.3s">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-orange-100 text-sm font-medium">Streak Atual</p>
                            <p class="text-4xl font-black" id="currentStreak">0</p>
                            <div class="flex items-center mt-2">
                                <i class="fas fa-fire text-yellow-300 text-xs animate-pulse"></i>
                                <span class="text-yellow-300 text-xs ml-1" id="streakTarget">Meta: 7 dias</span>
                            </div>
                        </div>
                        <div class="bg-white bg-opacity-20 p-4 rounded-full">
                            <i class="fas fa-fire text-3xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI-Powered Insights -->
            <div class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-2xl p-8 text-white mb-8 relative overflow-hidden animate-fade-in">
                <div class="absolute inset-0 bg-black opacity-10"></div>
                <div class="relative">
                    <div class="flex items-center mb-6">
                        <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                            <i class="fas fa-brain text-2xl"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold">ü§ñ Insights da IA</h3>
                            <p class="text-indigo-100">An√°lise inteligente do seu progresso</p>
                        </div>
                    </div>
                    <div id="aiInsights" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white bg-opacity-10 rounded-lg p-4">
                            <p class="text-indigo-100">Registre alguns treinos para receber insights personalizados e recomenda√ß√µes baseadas em IA!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Recent Activities -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 animate-fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-bold">üìã √öltimos Treinos</h3>
                        <button id="viewAllWorkouts" class="text-primary hover:text-primary-dark text-sm font-medium">
                            Ver todos <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                    <div id="recentWorkouts" class="space-y-4">
                        <div class="text-center py-12">
                            <i class="fas fa-dumbbell text-6xl text-gray-300 dark:text-gray-600 mb-4"></i>
                            <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum treino registrado ainda</p>
                            <p class="text-gray-400 dark:text-gray-500 text-sm">Comece seu primeiro treino para ver o progresso aqui!</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 animate-fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-bold">‚≠ê Exerc√≠cios Favoritos</h3>
                        <button class="text-primary hover:text-primary-dark text-sm font-medium">
                            Biblioteca <i class="fas fa-book ml-1"></i>
                        </button>
                    </div>
                    <div id="popularExercises" class="space-y-4">
                        <div class="text-center py-12">
                            <i class="fas fa-heart text-6xl text-gray-300 dark:text-gray-600 mb-4"></i>
                            <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum exerc√≠cio registrado ainda</p>
                            <p class="text-gray-400 dark:text-gray-500 text-sm">Seus exerc√≠cios mais praticados aparecer√£o aqui!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Workout Tab -->
        <div id="workout" class="tab-content hidden">
            <div class="max-w-7xl mx-auto">
                <!-- Enhanced Header -->
                <div class="text-center mb-10">
                    <h2 class="text-5xl font-black gradient-text bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-4">üèãÔ∏è‚Äç‚ôÇÔ∏è Novo Treino</h2>
                    <p class="text-xl text-gray-600 dark:text-gray-400">Configure seu treino perfeito com intelig√™ncia artificial</p>
                </div>

                <!-- Advanced Workout Timer -->
                <div class="workout-glow bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 rounded-3xl p-8 text-white mb-8 shadow-2xl relative overflow-hidden">
                    <div class="absolute inset-0 bg-black opacity-10"></div>
                    <div class="relative">
                        <div class="flex items-center justify-between mb-8">
                            <div class="flex items-center">
                                <div class="bg-white bg-opacity-20 p-4 rounded-full mr-4">
                                    <i class="fas fa-stopwatch text-3xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-2xl font-bold">‚è±Ô∏è Centro de Controle</h3>
                                    <p class="text-blue-100">Gerencie seu treino com precis√£o</p>
                                </div>
                            </div>
                            <div id="workoutIntensity" class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-semibold">
                                Aguardando in√≠cio
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                            <!-- Live Timer -->
                            <div class="text-center">
                                <div class="text-6xl font-black mb-3" id="liveTimer">00:00:00</div>
                                <div class="text-sm opacity-90 font-medium">Tempo de Treino</div>
                                <div class="text-xs opacity-75" id="caloriesBurned">~0 kcal queimadas</div>
                            </div>
                            
                            <!-- Rest Timer -->
                            <div class="text-center">
                                <div class="text-4xl font-bold text-yellow-300 mb-3" id="quickTimer">0:00</div>
                                <div class="text-sm opacity-90 font-medium">Descanso</div>
                                <div class="flex justify-center space-x-2 mt-3">
                                    <button class="quick-timer-btn bg-white bg-opacity-20 hover:bg-opacity-30 px-3 py-1 rounded-full text-xs transition-all" data-seconds="30">30s</button>
                                    <button class="quick-timer-btn bg-white bg-opacity-20 hover:bg-opacity-30 px-3 py-1 rounded-full text-xs transition-all" data-seconds="60">1m</button>
                                    <button class="quick-timer-btn bg-white bg-opacity-20 hover:bg-opacity-30 px-3 py-1 rounded-full text-xs transition-all" data-seconds="90">1:30</button>
                                    <button class="quick-timer-btn bg-white bg-opacity-20 hover:bg-opacity-30 px-3 py-1 rounded-full text-xs transition-all" data-seconds="120">2m</button>
                                </div>
                            </div>
                            
                            <!-- Volume Stats -->
                            <div class="text-center">
                                <div class="text-4xl font-bold text-green-300 mb-3" id="currentVolumeDisplay">0kg</div>
                                <div class="text-sm opacity-90 font-medium">Volume Atual</div>
                                <div class="text-xs opacity-75" id="currentExerciseDisplay">0 exerc√≠cios</div>
                            </div>

                            <!-- Heart Rate Zone -->
                            <div class="text-center">
                                <div class="text-4xl font-bold text-red-300 mb-3" id="heartRateZone">üíó 125</div>
                                <div class="text-sm opacity-90 font-medium">BPM Estimado</div>
                                <div class="text-xs opacity-75" id="heartRateZoneText">Zona Aer√≥bica</div>
                            </div>
                        </div>

                        <!-- Enhanced Control Buttons -->
                        <div class="flex justify-center space-x-4">
                            <button id="startWorkoutBtn" class="bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-2xl font-bold transition-all transform hover:scale-105 shadow-lg">
                                <i class="fas fa-play mr-3"></i>Iniciar Treino
                            </button>
                            <button id="pauseWorkoutBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white px-8 py-4 rounded-2xl font-bold transition-all transform hover:scale-105 shadow-lg hidden">
                                <i class="fas fa-pause mr-3"></i>Pausar
                            </button>
                            <button id="resumeWorkoutBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-4 rounded-2xl font-bold transition-all transform hover:scale-105 shadow-lg hidden">
                                <i class="fas fa-play mr-3"></i>Retomar
                            </button>
                            <button id="stopWorkoutBtn" class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-2xl font-bold transition-all transform hover:scale-105 shadow-lg hidden">
                                <i class="fas fa-stop mr-3"></i>Finalizar
                            </button>
                            <button id="quickStartBtn" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-4 rounded-2xl font-bold transition-all">
                                <i class="fas fa-clock mr-2"></i>Timer
                            </button>
                        </div>

                        <div id="workoutStatus" class="text-center mt-6">
                            <p id="statusText" class="text-lg opacity-90">Pressione "Iniciar Treino" para come√ßar sua jornada de transforma√ß√£o</p>
                        </div>
                    </div>
                </div>

                <!-- Smart Workout Builder -->
                <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 mb-8">
                    <div class="text-center mb-8">
                        <h3 class="text-3xl font-bold mb-2">üéØ Construtor Inteligente</h3>
                        <p class="text-gray-600 dark:text-gray-400">Selecione o tipo de treino e os exerc√≠cios ser√£o carregados automaticamente</p>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                        <button class="workout-type-btn group bg-gradient-to-br from-red-500 to-pink-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="peito">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">üí™</div>
                            <div class="font-bold text-lg">Peito</div>
                            <div class="text-xs opacity-80 mt-1">4 exerc√≠cios premium</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">For√ßa</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="costas">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">üî•</div>
                            <div class="font-bold text-lg">Costas</div>
                            <div class="text-xs opacity-80 mt-1">4 exerc√≠cios essenciais</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Postura</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-yellow-500 to-orange-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="ombros">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">üèÜ</div>
                            <div class="font-bold text-lg">Ombros</div>
                            <div class="text-xs opacity-80 mt-1">4 exerc√≠cios sculpting</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Defini√ß√£o</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-purple-500 to-violet-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="bra√ßos">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">üí•</div>
                            <div class="font-bold text-lg">Bra√ßos</div>
                            <div class="text-xs opacity-80 mt-1">4 exerc√≠cios potentes</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Hipertrofia</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-green-500 to-teal-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="pernas">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">ü¶µ</div>
                            <div class="font-bold text-lg">Pernas</div>
                            <div class="text-xs opacity-80 mt-1">5 exerc√≠cios intensos</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Explos√£o</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-gray-600 to-gray-800 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="core">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">‚ö°</div>
                            <div class="font-bold text-lg">Core</div>
                            <div class="text-xs opacity-80 mt-1">4 exerc√≠cios funcionais</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Estabilidade</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-cyan-500 to-blue-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="fullbody">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">üåü</div>
                            <div class="font-bold text-lg">Full Body</div>
                            <div class="text-xs opacity-80 mt-1">5 exerc√≠cios completos</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Total</div>
                        </button>
                        <button class="workout-type-btn group bg-gradient-to-br from-pink-500 to-rose-600 text-white p-6 rounded-2xl hover:scale-105 transition-all text-center shadow-lg" data-type="custom">
                            <div class="text-4xl mb-3 group-hover:animate-bounce">üé®</div>
                            <div class="font-bold text-lg">Custom</div>
                            <div class="text-xs opacity-80 mt-1">Totalmente personalizado</div>
                            <div class="mt-2 bg-white bg-opacity-20 rounded-full px-3 py-1 text-xs">Criativo</div>
                        </button>
                    </div>
                    
                    <div id="selectedWorkoutType" class="text-center p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-2xl">
                        <div class="text-6xl mb-4">‚ú®</div>
                        <p class="text-xl font-semibold text-gray-600 dark:text-gray-300">Selecione um tipo de treino acima</p>
                        <p class="text-gray-500 dark:text-gray-400 mt-2">Os exerc√≠cios ser√£o carregados automaticamente com configura√ß√µes otimizadas!</p>
                    </div>
                </div>
                
                <!-- Enhanced Workout Form -->
                <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8" id="workoutFormContainer" style="display: none;">
                    <form id="workoutForm">
                        <!-- Form Header -->
                        <div class="flex items-center justify-between mb-8">
                            <div>
                                <h3 class="text-3xl font-bold">üèãÔ∏è‚Äç‚ôÇÔ∏è Configura√ß√£o do Treino</h3>
                                <p class="text-gray-600 dark:text-gray-400 mt-1">Ajuste os detalhes para otimizar seus resultados</p>
                            </div>
                            <div class="flex space-x-3">
                                <button type="button" id="addExerciseBtn" class="bg-primary hover:bg-primary-dark text-white px-6 py-3 rounded-xl text-sm transition-all shadow-lg">
                                    <i class="fas fa-plus mr-2"></i>Adicionar Exerc√≠cio
                                </button>
                                <button type="button" id="clearExercisesBtn" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-xl text-sm transition-all shadow-lg">
                                    <i class="fas fa-trash mr-2"></i>Limpar
                                </button>
                            </div>
                        </div>

                        <!-- Enhanced Form Fields -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div>
                                <label class="block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300">üìÖ Data do Treino</label>
                                <input type="date" id="workoutDate" required
                                       class="w-full px-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary focus:border-primary bg-white dark:bg-gray-700 transition-all shadow-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300">üïê Hora de In√≠cio</label>
                                <input type="time" id="workoutStartTime" readonly
                                       class="w-full px-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-gray-100 dark:bg-gray-600 shadow-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300">‚è±Ô∏è Dura√ß√£o</label>
                                <input type="text" id="workoutDurationDisplay" readonly placeholder="Use o cron√¥metro"
                                       class="w-full px-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-gray-100 dark:bg-gray-600 shadow-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300">üéØ Intensidade</label>
                                <select id="workoutIntensitySelect" class="w-full px-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all shadow-sm">
                                    <option value="low">üòå Leve (50-60% FCM)</option>
                                    <option value="moderate" selected>üí™ Moderada (60-70% FCM)</option>
                                    <option value="high">üî• Alta (70-85% FCM)</option>
                                    <option value="extreme">üíÄ Extrema (85-95% FCM)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Exercise List -->
                        <div class="mb-8">
                            <h3 class="text-2xl font-bold mb-6 flex items-center">
                                <i class="fas fa-list-ul mr-3 text-primary"></i>
                                Exerc√≠cios do Treino
                            </h3>
                            
                            <div id="exerciseEntries" class="space-y-6">
                                <!-- Exercise entries will be added here dynamically -->
                            </div>
                            
                            <div id="exerciseEmptyState" class="text-center py-16 border-3 border-dashed border-gray-300 dark:border-gray-600 rounded-2xl bg-gray-50 dark:bg-gray-700">
                                <i class="fas fa-dumbbell text-8xl text-gray-400 mb-6"></i>
                                <h4 class="text-2xl font-bold text-gray-500 dark:text-gray-400 mb-2">Nenhum exerc√≠cio adicionado</h4>
                                <p class="text-gray-400 dark:text-gray-500">Selecione um tipo de treino acima para come√ßar!</p>
                            </div>
                        </div>

                        <!-- Enhanced Summary -->
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900 dark:to-indigo-900 rounded-2xl p-6 mb-8 border border-blue-200 dark:border-blue-700">
                            <h4 class="text-xl font-bold mb-4 text-blue-800 dark:text-blue-200">üìä Resumo Inteligente do Treino</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                                <div class="text-center">
                                    <div class="text-4xl font-black text-primary mb-2" id="summaryExercises">0</div>
                                    <div class="text-sm font-medium text-gray-600 dark:text-gray-400">Exerc√≠cios</div>
                                    <div class="text-xs text-blue-600 dark:text-blue-400 mt-1" id="exerciseVariety">0 grupos musculares</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-4xl font-black text-green-600 mb-2" id="summarySets">0</div>
                                    <div class="text-sm font-medium text-gray-600 dark:text-gray-400">S√©ries Totais</div>
                                    <div class="text-xs text-green-600 dark:text-green-400 mt-1" id="avgSets">0 por exerc√≠cio</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-4xl font-black text-orange-600 mb-2" id="summaryReps">0</div>
                                    <div class="text-sm font-medium text-gray-600 dark:text-gray-400">Repeti√ß√µes</div>
                                    <div class="text-xs text-orange-600 dark:text-orange-400 mt-1" id="avgReps">0 por s√©rie</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-4xl font-black text-purple-600 mb-2" id="summaryVolume">0kg</div>
                                    <div class="text-sm font-medium text-gray-600 dark:text-gray-400">Volume Total</div>
                                    <div class="text-xs text-purple-600 dark:text-purple-400 mt-1" id="estimatedTime">~0 min</div>
                                </div>
                            </div>
                            
                            <div id="workoutTips" class="mt-6 p-4 bg-blue-100 dark:bg-blue-800 rounded-xl">
                                <p class="text-sm text-blue-800 dark:text-blue-200 flex items-center">
                                    <i class="fas fa-lightbulb mr-3 text-yellow-500"></i>
                                    <span id="tipText">Adicione exerc√≠cios para receber dicas personalizadas da IA!</span>
                                </p>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex flex-col sm:flex-row justify-between space-y-4 sm:space-y-0 sm:space-x-6">
                            <button type="button" id="clearFormBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-4 rounded-xl transition-all shadow-lg">
                                <i class="fas fa-undo mr-3"></i>Limpar Tudo
                            </button>
                            <button type="submit" class="bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-12 py-4 rounded-xl transition-all font-bold transform hover:scale-105 shadow-2xl">
                                <i class="fas fa-rocket mr-3"></i>Finalizar Treino
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- New Goals Tab -->
        <div id="goals" class="tab-content hidden">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-bold mb-4">üéØ Metas e Objetivos</h2>
                <p class="text-xl text-gray-600 dark:text-gray-400">Defina e acompanhe seus objetivos de fitness</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Current Goals -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                    <h3 class="text-2xl font-bold mb-6 flex items-center">
                        <i class="fas fa-bullseye mr-3 text-primary"></i>
                        Metas Ativas
                    </h3>
                    <div id="currentGoals" class="space-y-4">
                        <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 p-6 rounded-xl border-l-4 border-blue-500">
                            <div class="flex justify-between items-start mb-3">
                                <h4 class="font-bold text-blue-800 dark:text-blue-200">Treinar 3x por semana</h4>
                                <span class="bg-blue-500 text-white px-2 py-1 rounded-full text-xs">66%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: 66%"></div>
                            </div>
                            <p class="text-sm text-blue-600 dark:text-blue-300">2 de 3 treinos completados esta semana</p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 p-6 rounded-xl border-l-4 border-green-500">
                            <div class="flex justify-between items-start mb-3">
                                <h4 class="font-bold text-green-800 dark:text-green-200">Atingir 5000kg de volume mensal</h4>
                                <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">23%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 23%"></div>
                            </div>
                            <p class="text-sm text-green-600 dark:text-green-300">1150kg de 5000kg este m√™s</p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 p-6 rounded-xl border-l-4 border-purple-500">
                            <div class="flex justify-between items-start mb-3">
                                <h4 class="font-bold text-purple-800 dark:text-purple-200">Streak de 30 dias</h4>
                                <span class="bg-purple-500 text-white px-2 py-1 rounded-full text-xs">13%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div class="bg-purple-500 h-2 rounded-full" style="width: 13%"></div>
                            </div>
                            <p class="text-sm text-purple-600 dark:text-purple-300">4 dias consecutivos</p>
                        </div>
                    </div>
                </div>

                <!-- New Goal Creator -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                    <h3 class="text-2xl font-bold mb-6 flex items-center">
                        <i class="fas fa-plus-circle mr-3 text-green-500"></i>
                        Nova Meta
                    </h3>
                    <form id="goalForm" class="space-y-6">
                        <div>
                            <label class="block text-sm font-semibold mb-2">Tipo de Meta</label>
                            <select id="goalType" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700">
                                <option value="frequency">Frequ√™ncia de Treino</option>
                                <option value="volume">Volume de Peso</option>
                                <option value="streak">Dias Consecutivos</option>
                                <option value="exercise">Exerc√≠cio Espec√≠fico</option>
                                <option value="time">Tempo de Treino</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">Valor Alvo</label>
                            <input type="number" id="goalTarget" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700" placeholder="Ex: 5">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">Per√≠odo</label>
                            <select id="goalPeriod" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700">
                                <option value="weekly">Por semana</option>
                                <option value="monthly">Por m√™s</option>
                                <option value="daily">Por dia</option>
                            </select>
                        </div>
                        <button type="submit" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition-all">
                            <i class="fas fa-target mr-2"></i>Criar Meta
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Enhanced Exercise Database -->
        <div id="exercises" class="tab-content hidden">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-bold mb-4">üìö Base de Exerc√≠cios Premium</h2>
                <p class="text-xl text-gray-600 dark:text-gray-400">Biblioteca completa com instru√ß√µes detalhadas e dicas profissionais</p>
            </div>

            <div class="mb-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="relative">
                        <i class="fas fa-search absolute left-4 top-4 text-gray-400"></i>
                        <input type="text" id="exerciseSearch" placeholder="Buscar exerc√≠cios por nome..." 
                               class="w-full pl-12 pr-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary focus:border-primary bg-white dark:bg-gray-700 transition-all shadow-sm">
                    </div>
                    <select id="muscleFilter" class="px-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all shadow-sm">
                        <option value="">üéØ Todos os m√∫sculos</option>
                        <option value="peito">üí™ Peito</option>
                        <option value="costas">üî• Costas</option>
                        <option value="ombros">üèÜ Ombros</option>
                        <option value="bra√ßos">üí• Bra√ßos</option>
                        <option value="pernas">ü¶µ Pernas</option>
                        <option value="core">‚ö° Core</option>
                    </select>
                    <select id="difficultyFilter" class="px-4 py-4 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all shadow-sm">
                        <option value="">üìä Todas as dificuldades</option>
                        <option value="beginner">üòå Iniciante</option>
                        <option value="intermediate">üí™ Intermedi√°rio</option>
                        <option value="advanced">üî• Avan√ßado</option>
                    </select>
                </div>
            </div>

            <div id="exerciseList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Enhanced exercise cards will be populated here -->
            </div>
        </div>

        <!-- Enhanced Analytics -->
        <div id="analytics" class="tab-content hidden">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-bold mb-4">üìä An√°lises Avan√ßadas</h2>
                <p class="text-xl text-gray-600 dark:text-gray-400">Insights detalhados sobre seu progresso e performance</p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-chart-line mr-3 text-blue-500"></i>
                        Progresso Semanal
                    </h3>
                    <canvas id="weeklyChart" width="400" height="200"></canvas>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-chart-pie mr-3 text-green-500"></i>
                        Distribui√ß√£o Muscular
                    </h3>
                    <canvas id="muscleChart" width="400" height="200"></canvas>
                </div>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                <h3 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-trophy mr-3 text-yellow-500"></i>
                    Recordes Pessoais
                </h3>
                <div id="personalRecords" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center p-6 bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900 dark:to-orange-900 rounded-xl">
                        <i class="fas fa-crown text-4xl text-yellow-500 mb-3"></i>
                        <h4 class="font-bold text-xl">Maior Volume</h4>
                        <p class="text-3xl font-black text-yellow-600">0kg</p>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Em um √∫nico treino</p>
                    </div>
                    <div class="text-center p-6 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900 dark:to-emerald-900 rounded-xl">
                        <i class="fas fa-clock text-4xl text-green-500 mb-3"></i>
                        <h4 class="font-bold text-xl">Maior Dura√ß√£o</h4>
                        <p class="text-3xl font-black text-green-600">0min</p>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Treino mais longo</p>
                    </div>
                    <div class="text-center p-6 bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900 dark:to-violet-900 rounded-xl">
                        <i class="fas fa-fire text-4xl text-purple-500 mb-3"></i>
                        <h4 class="font-bold text-xl">Melhor Streak</h4>
                        <p class="text-3xl font-black text-purple-600">0</p>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Dias consecutivos</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Tools -->
        <div id="tools" class="tab-content hidden">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-bold mb-4">üõ†Ô∏è Ferramentas Profissionais</h2>
                <p class="text-xl text-gray-600 dark:text-gray-400">Calculadoras e utilit√°rios para otimizar seus treinos</p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Enhanced 1RM Calculator -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                    <div class="flex items-center mb-6">
                        <div class="bg-primary bg-opacity-10 p-3 rounded-full mr-4">
                            <i class="fas fa-calculator text-2xl text-primary"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold">Calculadora 1RM</h3>
                            <p class="text-gray-600 dark:text-gray-400">F√≥rmula de Brzycki</p>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-semibold mb-2">Peso utilizado (kg)</label>
                            <input type="number" id="rmWeight" step="0.5" placeholder="100" 
                                   class="w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">Repeti√ß√µes realizadas</label>
                            <input type="number" id="rmReps" min="1" max="20" placeholder="8" 
                                   class="w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all">
                        </div>
                        <button id="calculate1RMBtn" class="w-full bg-primary hover:bg-primary-dark text-white py-3 rounded-xl font-semibold transition-all shadow-lg">
                            <i class="fas fa-calculator mr-2"></i>Calcular 1RM
                        </button>
                        <div id="rmResult" class="hidden p-6 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900 dark:to-emerald-900 rounded-xl border-l-4 border-green-500">
                            <p class="text-green-800 dark:text-green-200 font-semibold mb-2">Sua repeti√ß√£o m√°xima estimada:</p>
                            <p class="text-4xl font-black text-green-600 dark:text-green-400" id="rmValue">-</p>
                            <div class="mt-4 text-sm text-green-700 dark:text-green-300">
                                <p><strong>90%:</strong> <span id="rm90">-</span>kg</p>
                                <p><strong>80%:</strong> <span id="rm80">-</span>kg</p>
                                <p><strong>70%:</strong> <span id="rm70">-</span>kg</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced BMI Calculator -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                    <div class="flex items-center mb-6">
                        <div class="bg-green-500 bg-opacity-10 p-3 rounded-full mr-4">
                            <i class="fas fa-weight text-2xl text-green-500"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold">Calculadora IMC</h3>
                            <p class="text-gray-600 dark:text-gray-400">√çndice de Massa Corporal</p>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-semibold mb-2">Peso (kg)</label>
                            <input type="number" id="bmiWeight" step="0.1" placeholder="70" 
                                   class="w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">Altura (cm)</label>
                            <input type="number" id="bmiHeight" placeholder="175" 
                                   class="w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all">
                        </div>
                        <button id="calculateBMIBtn" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-semibold transition-all shadow-lg">
                            <i class="fas fa-weight mr-2"></i>Calcular IMC
                        </button>
                        <div id="bmiResult" class="hidden p-6 rounded-xl border-l-4">
                            <p class="font-semibold mb-2">Seu IMC:</p>
                            <p class="text-4xl font-black mb-2" id="bmiValue">-</p>
                            <p class="text-lg font-semibold" id="bmiCategory">-</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Rest Timer -->
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center">
                        <div class="bg-orange-500 bg-opacity-10 p-3 rounded-full mr-4">
                            <i class="fas fa-stopwatch text-2xl text-orange-500"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold">Timer de Descanso Profissional</h3>
                            <p class="text-gray-600 dark:text-gray-400">Otimize seus intervalos entre s√©ries</p>
                        </div>
                    </div>
                </div>
                
                <div class="text-center space-y-8">
                    <div class="text-8xl font-black text-primary" id="timerDisplay">0:00</div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <button class="timer-preset-btn bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-6 py-4 rounded-xl font-semibold transition-all" data-time="45">45s<br><small>Cardio</small></button>
                        <button class="timer-preset-btn bg-blue-100 hover:bg-blue-200 dark:bg-blue-800 dark:hover:bg-blue-700 text-blue-800 dark:text-blue-200 px-6 py-4 rounded-xl font-semibold transition-all" data-time="60">1min<br><small>For√ßa</small></button>
                        <button class="timer-preset-btn bg-green-100 hover:bg-green-200 dark:bg-green-800 dark:hover:bg-green-700 text-green-800 dark:text-green-200 px-6 py-4 rounded-xl font-semibold transition-all" data-time="90">1:30<br><small>Hipertrofia</small></button>
                        <button class="timer-preset-btn bg-purple-100 hover:bg-purple-200 dark:bg-purple-800 dark:hover:bg-purple-700 text-purple-800 dark:text-purple-200 px-6 py-4 rounded-xl font-semibold transition-all" data-time="180">3min<br><small>For√ßa Max</small></button>
                    </div>
                    
                    <div class="flex justify-center space-x-4">
                        <button id="timerBtn" class="bg-primary hover:bg-primary-dark text-white px-8 py-4 rounded-xl font-bold text-lg transition-all shadow-lg">
                            <i class="fas fa-play mr-2"></i>Iniciar
                        </button>
                        <button id="resetTimerBtn" class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all shadow-lg">
                            <i class="fas fa-stop mr-2"></i>Parar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Progress Tab -->
        <div id="progress" class="tab-content hidden">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-bold mb-4">üèÜ Progresso e Conquistas</h2>
                <p class="text-xl text-gray-600 dark:text-gray-400">Acompanhe sua evolu√ß√£o e desbloqueie novos n√≠veis</p>
            </div>

            <!-- Level System -->
            <div class="bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-3xl p-8 text-white mb-8 relative overflow-hidden">
                <div class="absolute inset-0 bg-black opacity-10"></div>
                <div class="relative">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="bg-white bg-opacity-20 p-4 rounded-full mr-4">
                                <i class="fas fa-crown text-3xl"></i>
                            </div>
                            <div>
                                <h3 class="text-3xl font-bold">N√≠vel Atual</h3>
                                <p class="text-yellow-100">Sistema de Progress√£o FitTracker</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-6xl font-black" id="currentLevel">1</div>
                            <div class="text-lg" id="currentLevelName">Iniciante</div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex justify-between text-sm mb-2">
                            <span>XP: <span id="currentXP">0</span></span>
                            <span>Pr√≥ximo n√≠vel: <span id="nextLevelXP">100</span></span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-4">
                            <div class="bg-white h-4 rounded-full transition-all duration-500" style="width: 0%" id="xpProgress"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold" id="totalWorkoutsLevel">0</div>
                            <div class="text-yellow-100 text-sm">Treinos Completados</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold" id="totalVolumeLevel">0kg</div>
                            <div class="text-yellow-100 text-sm">Volume Total Levantado</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold" id="bestStreakLevel">0</div>
                            <div class="text-yellow-100 text-sm">Melhor Sequ√™ncia</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Achievements Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="achievementsGrid">
                <!-- Achievements will be populated here -->
            </div>
        </div>

        <!-- Enhanced History -->
        <div id="history" class="tab-content hidden">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-4xl font-bold">üìö Hist√≥rico Completo</h2>
                    <p class="text-xl text-gray-600 dark:text-gray-400 mt-2">Todos os seus treinos organizados e detalhados</p>
                </div>
                <div class="flex space-x-3">
                    <select id="historyFilter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700">
                        <option value="all">Todos os treinos</option>
                        <option value="week">√öltima semana</option>
                        <option value="month">√öltimo m√™s</option>
                        <option value="3months">√öltimos 3 meses</option>
                    </select>
                    <button id="exportHistoryBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-xl transition-all shadow-lg">
                        <i class="fas fa-download mr-2"></i>Exportar
                    </button>
                    <button id="clearHistoryBtn" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-xl transition-all shadow-lg">
                        <i class="fas fa-trash mr-2"></i>Limpar
                    </button>
                </div>
            </div>
            <div id="workoutHistory" class="space-y-6">
                <div class="text-center py-16">
                    <i class="fas fa-history text-8xl text-gray-300 dark:text-gray-600 mb-6"></i>
                    <h3 class="text-2xl font-bold text-gray-500 dark:text-gray-400 mb-2">Nenhum treino registrado ainda</h3>
                    <p class="text-gray-400 dark:text-gray-500">Seus treinos aparecer√£o aqui ap√≥s serem salvos!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="floating-action">
        <button id="quickWorkoutBtn" class="bg-gradient-to-r from-primary to-primary-dark text-white p-4 rounded-full shadow-2xl hover:scale-110 transition-all duration-300 animate-pulse">
            <i class="fas fa-plus text-2xl"></i>
        </button>
    </div>

    <!-- Enhanced Success Message -->
    <div id="successMessage" class="hidden fixed top-4 right-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-4 rounded-2xl shadow-2xl z-50 animate-slide-in">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-3 text-2xl"></i>
            <span id="successText" class="font-semibold">Opera√ß√£o realizada com sucesso!</span>
        </div>
    </div>

    <!-- Enhanced Notification System -->
    <div id="notificationContainer" class="fixed top-4 left-4 space-y-2 z-50">
        <!-- Notifications will appear here -->
    </div>

    <script>
        // Global variables with enhanced features
        let workouts = [];
        let selectedWorkoutType = null;
        let exerciseIndex = 0;
        let currentLevel = 1;
        let currentXP = 0;
        let goals = [];
        let achievements = [];
        
        // Timer variables
        let workoutTimer = null;
        let workoutStartTime = null;
        let workoutElapsedTime = 0;
        let isWorkoutRunning = false;
        let isWorkoutPaused = false;
        let totalCaloriesBurned = 0;
        
        // Quick timer variables
        let quickTimer = null;
        let quickTimerSeconds = 0;
        let isQuickTimerRunning = false;
        
        // Rest timer variables
        let restTimer = null;
        let restTimerSeconds = 0;
        let isRestTimerRunning = false;

        // Enhanced exercise database with difficulty levels
        const exerciseDatabase = [
            // Peito
            { name: "Supino Reto", muscle: "peito", difficulty: "intermediate", instructions: "Deite no banco, segure a barra com pegada um pouco mais larga que os ombros. Des√ßa controladamente at√© o peito e empurre para cima.", tips: "Mantenha os ombros retra√≠dos e core contra√≠do", caloriesPerRep: 1.2 },
            { name: "Supino Inclinado", muscle: "peito", difficulty: "intermediate", instructions: "Similar ao supino reto, mas em banco inclinado (30-45¬∞). Trabalha mais a parte superior do peitoral.", tips: "Foque na parte superior do peito", caloriesPerRep: 1.3 },
            { name: "Flex√£o de Bra√ßo", muscle: "peito", difficulty: "beginner", instructions: "Em posi√ß√£o de prancha, des√ßa o corpo flexionando os bra√ßos at√© quase tocar o ch√£o, depois empurre para cima.", tips: "Mantenha o corpo alinhado", caloriesPerRep: 0.8 },
            { name: "Crucifixo", muscle: "peito", difficulty: "advanced", instructions: "Deitado no banco, segure halteres com bra√ßos abertos. Aproxime os halteres acima do peito contraindo o peitoral.", tips: "Movimento amplo e controlado", caloriesPerRep: 1.1 },
            
            // Costas
            { name: "Puxada na Polia Alta", muscle: "costas", difficulty: "intermediate", instructions: "Sentado, puxe a barra em dire√ß√£o ao peito, contraindo as esc√°pulas. Retorne controladamente.", tips: "Puxe com as costas, n√£o com os bra√ßos", caloriesPerRep: 1.4 },
            { name: "Remada Curvada", muscle: "costas", difficulty: "advanced", instructions: "Inclinado para frente, puxe a barra em dire√ß√£o ao abd√¥men, mantendo as esc√°pulas contra√≠das.", tips: "Mantenha as costas retas", caloriesPerRep: 1.5 },
            { name: "Barra Fixa", muscle: "costas", difficulty: "advanced", instructions: "Pendure na barra e puxe o corpo para cima at√© o queixo passar da barra. Des√ßa controladamente.", tips: "Use a for√ßa das costas", caloriesPerRep: 2.0 },
            { name: "Remada Unilateral", muscle: "costas", difficulty: "intermediate", instructions: "Apoiado no banco, puxe o halter em dire√ß√£o √† cintura, contraindo as costas.", tips: "Foque na amplitude do movimento", caloriesPerRep: 1.2 },
            
            // Ombros
            { name: "Desenvolvimento", muscle: "ombros", difficulty: "intermediate", instructions: "Sentado ou em p√©, empurre os halteres ou barra acima da cabe√ßa. Des√ßa controladamente.", tips: "N√£o arqueie as costas", caloriesPerRep: 1.3 },
            { name: "Eleva√ß√£o Lateral", muscle: "ombros", difficulty: "beginner", instructions: "Com halteres nas m√£os, eleve os bra√ßos lateralmente at√© a altura dos ombros.", tips: "Movimento controlado e fluido", caloriesPerRep: 0.9 },
            { name: "Eleva√ß√£o Frontal", muscle: "ombros", difficulty: "beginner", instructions: "Eleve o halter √† frente do corpo at√© a altura dos ombros, alternando os bra√ßos.", tips: "Evite balan√ßar o corpo", caloriesPerRep: 0.8 },
            { name: "Crucifixo Inverso", muscle: "ombros", difficulty: "intermediate", instructions: "Inclinado para frente, abra os bra√ßos lateralmente contraindo a parte posterior dos ombros.", tips: "Foque nos deltoides posteriores", caloriesPerRep: 1.0 },
            
            // Bra√ßos
            { name: "Rosca Direta", muscle: "bra√ßos", difficulty: "beginner", instructions: "Com barra ou halteres, flexione os cotovelos contraindo o b√≠ceps. Mantenha os cotovelos fixos.", tips: "Movimento lento e controlado", caloriesPerRep: 0.7 },
            { name: "Tr√≠ceps Testa", muscle: "bra√ßos", difficulty: "intermediate", instructions: "Deitado, flexione apenas os antebra√ßos, levando a barra em dire√ß√£o √† testa.", tips: "Mantenha os cotovelos fixos", caloriesPerRep: 0.9 },
            { name: "Rosca Martelo", muscle: "bra√ßos", difficulty: "beginner", instructions: "Com halteres em pegada neutra, flexione os cotovelos alternadamente.", tips: "Pegada neutra trabalha mais o braquial", caloriesPerRep: 0.8 },
            { name: "Tr√≠ceps Pulley", muscle: "bra√ßos", difficulty: "beginner", instructions: "Na polia alta, empurre a barra para baixo estendendo completamente os bra√ßos.", tips: "Mantenha os cotovelos colados ao corpo", caloriesPerRep: 0.6 },
            
            // Pernas
            { name: "Agachamento", muscle: "pernas", difficulty: "intermediate", instructions: "Des√ßa flexionando joelhos e quadris como se fosse sentar, mantendo o peito ereto. Suba contraindo gl√∫teos e quadr√≠ceps.", tips: "Rei dos exerc√≠cios - trabalha corpo inteiro", caloriesPerRep: 2.5 },
            { name: "Leg Press", muscle: "pernas", difficulty: "beginner", instructions: "No aparelho, empurre a plataforma com os p√©s, estendendo as pernas completamente.", tips: "Amplitude completa do movimento", caloriesPerRep: 2.0 },
            { name: "Cadeira Extensora", muscle: "pernas", difficulty: "beginner", instructions: "Sentado, estenda as pernas contraindo o quadr√≠ceps. Retorne controladamente.", tips: "Pausa no topo da contra√ß√£o", caloriesPerRep: 1.2 },
            { name: "Mesa Flexora", muscle: "pernas", difficulty: "beginner", instructions: "Deitado de bru√ßos, flexione as pernas contraindo os posteriores da coxa.", tips: "Foque nos isquiotibiais", caloriesPerRep: 1.3 },
            { name: "Panturrilha em P√©", muscle: "pernas", difficulty: "beginner", instructions: "Na ponta dos p√©s, eleve o corpo contraindo as panturrilhas. Des√ßa controladamente.", tips: "Amplitude m√°xima de movimento", caloriesPerRep: 0.8 },
            
            // Core
            { name: "Abdominal Supra", muscle: "core", difficulty: "beginner", instructions: "Deitado, flexione o tronco contraindo o abd√¥men, sem puxar o pesco√ßo.", tips: "Qualidade sobre quantidade", caloriesPerRep: 0.5 },
            { name: "Prancha", muscle: "core", difficulty: "intermediate", instructions: "Mantenha o corpo reto apoiado nos antebra√ßos e p√©s, contraindo core e gl√∫teos.", tips: "Corpo alinhado como uma prancha", caloriesPerRep: 0.3 },
            { name: "Abdominal Obl√≠quo", muscle: "core", difficulty: "intermediate", instructions: "Deitado de lado, flexione o tronco lateralmente contraindo os obl√≠quos.", tips: "Trabalha a cintura", caloriesPerRep: 0.4 },
            { name: "Mountain Climber", muscle: "core", difficulty: "advanced", instructions: "Em posi√ß√£o de prancha, alterne levando os joelhos em dire√ß√£o ao peito rapidamente.", tips: "Exerc√≠cio cardiovascular intenso", caloriesPerRep: 0.8 }
        ];

        // Enhanced workout templates with difficulty progression
        const workoutTemplates = {
            peito: [
                { exercise: "Supino Reto", sets: 4, reps: 8, weight: 60 },
                { exercise: "Supino Inclinado", sets: 3, reps: 10, weight: 50 },
                { exercise: "Crucifixo", sets: 3, reps: 12, weight: 15 },
                { exercise: "Flex√£o de Bra√ßo", sets: 3, reps: 15, weight: 0 }
            ],
            costas: [
                { exercise: "Puxada na Polia Alta", sets: 4, reps: 8, weight: 50 },
                { exercise: "Remada Curvada", sets: 3, reps: 10, weight: 40 },
                { exercise: "Barra Fixa", sets: 3, reps: 8, weight: 0 },
                { exercise: "Remada Unilateral", sets: 3, reps: 12, weight: 25 }
            ],
            ombros: [
                { exercise: "Desenvolvimento", sets: 4, reps: 10, weight: 30 },
                { exercise: "Eleva√ß√£o Lateral", sets: 3, reps: 12, weight: 10 },
                { exercise: "Eleva√ß√£o Frontal", sets: 3, reps: 12, weight: 8 },
                { exercise: "Crucifixo Inverso", sets: 3, reps: 15, weight: 8 }
            ],
            bra√ßos: [
                { exercise: "Rosca Direta", sets: 4, reps: 10, weight: 20 },
                { exercise: "Tr√≠ceps Testa", sets: 4, reps: 10, weight: 30 },
                { exercise: "Rosca Martelo", sets: 3, reps: 12, weight: 15 },
                { exercise: "Tr√≠ceps Pulley", sets: 3, reps: 12, weight: 25 }
            ],
            pernas: [
                { exercise: "Agachamento", sets: 4, reps: 10, weight: 70 },
                { exercise: "Leg Press", sets: 3, reps: 12, weight: 150 },
                { exercise: "Cadeira Extensora", sets: 3, reps: 15, weight: 40 },
                { exercise: "Mesa Flexora", sets: 3, reps: 12, weight: 35 },
                { exercise: "Panturrilha em P√©", sets: 4, reps: 20, weight: 60 }
            ],
            core: [
                { exercise: "Abdominal Supra", sets: 4, reps: 20, weight: 0 },
                { exercise: "Prancha", sets: 3, reps: 60, weight: 0 },
                { exercise: "Abdominal Obl√≠quo", sets: 3, reps: 15, weight: 0 },
                { exercise: "Mountain Climber", sets: 3, reps: 20, weight: 0 }
            ],
            fullbody: [
                { exercise: "Agachamento", sets: 3, reps: 10, weight: 60 },
                { exercise: "Supino Reto", sets: 3, reps: 10, weight: 50 },
                { exercise: "Puxada na Polia Alta", sets: 3, reps: 10, weight: 45 },
                { exercise: "Desenvolvimento", sets: 3, reps: 12, weight: 25 },
                { exercise: "Prancha", sets: 3, reps: 30, weight: 0 }
            ]
        };

        // Achievement system
        const achievementDefinitions = [
            { id: 'first_workout', name: 'Primeira Jornada', description: 'Complete seu primeiro treino', icon: 'üéØ', xp: 50, condition: () => workouts.length >= 1 },
            { id: 'week_warrior', name: 'Guerreiro da Semana', description: 'Fa√ßa 5 treinos em uma semana', icon: '‚öîÔ∏è', xp: 100, condition: () => getWeeklyWorkouts() >= 5 },
            { id: 'consistency_king', name: 'Rei da Consist√™ncia', description: 'Mantenha um streak de 7 dias', icon: 'üëë', xp: 200, condition: () => getCurrentStreak() >= 7 },
            { id: 'volume_master', name: 'Mestre do Volume', description: 'Atinja 5000kg de volume total', icon: 'üí™', xp: 300, condition: () => getTotalVolume() >= 5000 },
            { id: 'exercise_explorer', name: 'Explorador de Exerc√≠cios', description: 'Fa√ßa 20 exerc√≠cios diferentes', icon: 'üó∫Ô∏è', xp: 150, condition: () => getUniqueExercises() >= 20 },
            { id: 'beast_mode', name: 'Modo Fera', description: 'Complete 50 treinos', icon: 'ü¶Å', xp: 500, condition: () => workouts.length >= 50 },
            { id: 'strength_legend', name: 'Lenda da For√ßa', description: 'Atinja n√≠vel 5', icon: 'üèÜ', xp: 1000, condition: () => currentLevel >= 5 },
            { id: 'marathon_mindset', name: 'Mentalidade Maratona', description: 'Acumule 1000 minutos de treino', icon: 'üèÉ', xp: 400, condition: () => getTotalTime() >= 1000 }
        ];

        // Level system
        const levelThresholds = [0, 100, 300, 600, 1000, 1500, 2100, 2800, 3600, 4500, 5500];
        const levelNames = ['Iniciante', 'Novato', 'Aprendiz', 'Intermedi√°rio', 'Experiente', 'Avan√ßado', 'Elite', 'Mestre', 'Lenda', 'Imortal'];

        // Dark mode setup
        let isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (isDarkMode) {
            document.documentElement.classList.add('dark');
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ FitTracker Pro carregado!');
            
            updateCurrentDateTime();
            populateEnhancedExerciseList();
            updateEnhancedDashboard();
            initializeAchievements();
            setupEventListeners();
            
            // Set default date to today
            document.getElementById('workoutDate').value = new Date().toISOString().split('T')[0];
            
            // Start time update interval
            setInterval(updateCurrentDateTime, 1000);
            
            console.log('‚úÖ Inicializa√ß√£o completa com recursos avan√ßados!');
        });

        // Enhanced date/time update
        function updateCurrentDateTime() {
            const now = new Date();
            const dateOptions = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const timeOptions = {
                hour: '2-digit',
                minute: '2-digit'
            };
            
            document.getElementById('currentDate').textContent = 
                now.toLocaleDateString('pt-BR', dateOptions);
            document.getElementById('currentTime').textContent = 
                now.toLocaleTimeString('pt-BR', timeOptions);
        }

        // Enhanced event listeners
        function setupEventListeners() {
            console.log('‚öôÔ∏è Configurando event listeners avan√ßados...');
            
            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
            
            // Tab navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    switchTab(targetTab);
                });
            });

            // Workout timer buttons
            document.getElementById('startWorkoutBtn').addEventListener('click', startAdvancedWorkout);
            document.getElementById('pauseWorkoutBtn').addEventListener('click', pauseWorkout);
            document.getElementById('resumeWorkoutBtn').addEventListener('click', resumeWorkout);
            document.getElementById('stopWorkoutBtn').addEventListener('click', stopWorkout);
            document.getElementById('quickStartBtn').addEventListener('click', toggleQuickTimer);

            // Quick timer preset buttons
            document.querySelectorAll('.quick-timer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const seconds = parseInt(this.dataset.seconds);
                    startQuickTimer(seconds);
                });
            });

            // Workout type buttons
            document.querySelectorAll('.workout-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const type = this.dataset.type;
                    selectAdvancedWorkoutType(type);
                });
            });

            // Form buttons
            document.getElementById('addExerciseBtn').addEventListener('click', addExercise);
            document.getElementById('clearExercisesBtn').addEventListener('click', clearExercises);
            document.getElementById('clearFormBtn').addEventListener('click', clearForm);
            document.getElementById('workoutForm').addEventListener('submit', handleAdvancedFormSubmit);

            // Calculator buttons
            document.getElementById('calculate1RMBtn').addEventListener('click', calculateAdvanced1RM);
            document.getElementById('calculateBMIBtn').addEventListener('click', calculateAdvancedBMI);

            // Rest timer
            document.getElementById('timerBtn').addEventListener('click', toggleRestTimer);
            document.getElementById('resetTimerBtn').addEventListener('click', resetRestTimer);
            document.querySelectorAll('.timer-preset-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const seconds = parseInt(this.dataset.time);
                    setRestTimer(seconds);
                });
            });

            // History actions
            document.getElementById('clearHistoryBtn').addEventListener('click', clearHistory);
            document.getElementById('exportHistoryBtn').addEventListener('click', exportHistory);

            // Floating action button
            document.getElementById('quickWorkoutBtn').addEventListener('click', () => switchTab('workout'));

            // Goal form
            document.getElementById('goalForm').addEventListener('submit', createGoal);

            console.log('‚úÖ Event listeners avan√ßados configurados!');
        }

        // Dark mode toggle
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark');
            const icon = document.querySelector('#darkModeToggle i');
            icon.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            
            showNotification('success', `Modo ${isDarkMode ? 'escuro' : 'claro'} ativado!`);
        }

        // Enhanced notification system
        function showNotification(type, message, duration = 3000) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            const colors = {
                success: 'from-green-500 to-emerald-600',
                error: 'from-red-500 to-red-600',
                warning: 'from-yellow-500 to-orange-500',
                info: 'from-blue-500 to-indigo-600'
            };
            
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };
            
            notification.className = `bg-gradient-to-r ${colors[type]} text-white px-6 py-4 rounded-xl shadow-2xl animate-slide-in flex items-center space-x-3`;
            notification.innerHTML = `
                <i class="fas ${icons[type]} text-xl"></i>
                <span class="font-semibold">${message}</span>
                <button class="ml-auto hover:bg-white hover:bg-opacity-20 p-1 rounded" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, duration);
        }

        // Enhanced workout timer with calorie tracking
        function startAdvancedWorkout() {
            console.log('üöÄ Iniciando treino avan√ßado...');
            
            if (!isWorkoutRunning) {
                workoutStartTime = new Date();
                workoutElapsedTime = 0;
                isWorkoutRunning = true;
                isWorkoutPaused = false;
                totalCaloriesBurned = 0;
                
                // Update UI
                const startTime = workoutStartTime.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                document.getElementById('workoutStartTime').value = startTime;
                document.getElementById('statusText').textContent = 'Treino em andamento... Transforme-se! üî•';
                document.getElementById('workoutIntensity').textContent = 'Em andamento';
                
                // Show/hide buttons
                document.getElementById('startWorkoutBtn').classList.add('hidden');
                document.getElementById('pauseWorkoutBtn').classList.remove('hidden');
                document.getElementById('stopWorkoutBtn').classList.remove('hidden');
                
                // Start timer
                workoutTimer = setInterval(updateAdvancedWorkoutTimer, 1000);
                
                showNotification('success', 'Treino iniciado! Vamos conquistar seus objetivos! üí™');
            }
        }

        function updateAdvancedWorkoutTimer() {
            if (isWorkoutRunning && !isWorkoutPaused) {
                const now = new Date();
                workoutElapsedTime = Math.floor((now - workoutStartTime) / 1000);
                
                const hours = Math.floor(workoutElapsedTime / 3600);
                const minutes = Math.floor((workoutElapsedTime % 3600) / 60);
                const seconds = workoutElapsedTime % 60;
                
                const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('liveTimer').textContent = display;
                
                // Update calorie estimation (rough calculation)
                const caloriesPerMinute = 8; // Average for weight training
                const estimatedCalories = Math.floor((workoutElapsedTime / 60) * caloriesPerMinute);
                document.getElementById('caloriesBurned').textContent = `~${estimatedCalories} kcal queimadas`;
                
                // Update heart rate estimation
                const baseHR = 70;
                const intensityMultiplier = 1.8; // Moderate intensity
                const estimatedHR = Math.floor(baseHR * intensityMultiplier + Math.random() * 10);
                document.getElementById('heartRateZone').textContent = `üíó ${estimatedHR}`;
                
                const zones = ['Repouso', 'Queima de Gordura', 'Aer√≥bica', 'Anaer√≥bica', 'M√°xima'];
                let zone = 'Aer√≥bica';
                if (estimatedHR < 100) zone = 'Queima de Gordura';
                else if (estimatedHR > 160) zone = 'Anaer√≥bica';
                else if (estimatedHR > 180) zone = 'M√°xima';
                
                document.getElementById('heartRateZoneText').textContent = `Zona ${zone}`;
            }
        }

        // Enhanced workout type selection
        function selectAdvancedWorkoutType(type) {
            console.log('üéØ Tipo de treino avan√ßado selecionado:', type);
            
            selectedWorkoutType = type;
            
            // Update UI feedback with animations
            document.querySelectorAll('.workout-type-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-white', 'ring-opacity-50', 'scale-110', 'transform');
            });
            
            const selectedBtn = document.querySelector(`[data-type="${type}"]`);
            selectedBtn.classList.add('ring-4', 'ring-white', 'ring-opacity-50', 'scale-110', 'transform');
            
            // Type names with enhanced descriptions
            const typeNames = {
                peito: 'üí™ Treino de Peito - For√ßa e Defini√ß√£o',
                costas: 'üî• Treino de Costas - Postura e Poder', 
                ombros: 'üèÜ Treino de Ombros - Largura e Simetria',
                bra√ßos: 'üí• Treino de Bra√ßos - Massa e Defini√ß√£o',
                pernas: 'ü¶µ Treino de Pernas - Explos√£o e Resist√™ncia',
                core: '‚ö° Treino de Core - Estabilidade e For√ßa',
                fullbody: 'üåü Treino Full Body - Funcional e Completo',
                custom: 'üé® Treino Personalizado - Sua Criatividade'
            };
            
            // Show workout form
            document.getElementById('workoutFormContainer').style.display = 'block';
            
            // Clear previous entries
            clearExercises();
            
            // Auto-load template with enhanced feedback
            if (type !== 'custom' && workoutTemplates[type]) {
                console.log('üîÑ Carregando template inteligente para:', type);
                
                document.getElementById('selectedWorkoutType').innerHTML = `
                    <div class="text-center animate-fade-in">
                        <div class="text-6xl mb-4">‚úÖ</div>
                        <h4 class="text-2xl font-bold text-primary mb-2">${typeNames[type]}</h4>
                        <p class="text-green-600 dark:text-green-400 font-semibold mb-2">
                            ‚ú® ${workoutTemplates[type].length} exerc√≠cios carregados automaticamente!
                        </p>
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900 dark:to-emerald-900 rounded-xl p-4 mt-4">
                            <p class="text-sm text-green-700 dark:text-green-300">
                                <i class="fas fa-robot mr-2"></i>
                                IA otimizou os pesos e repeti√ß√µes baseado no seu n√≠vel
                            </p>
                        </div>
                    </div>
                `;
                
                // Load template exercises with enhanced display
                const template = workoutTemplates[type];
                template.forEach(exerciseData => {
                    addExerciseFromTemplate(exerciseData);
                });
                
                updateExerciseEmptyState();
                updateAdvancedCurrentStats();
                
                showNotification('success', `${typeNames[type]} carregado com ${template.length} exerc√≠cios otimizados! üéØ`);
                
            } else if (type === 'custom') {
                document.getElementById('selectedWorkoutType').innerHTML = `
                    <div class="text-center animate-fade-in">
                        <div class="text-6xl mb-4">üé®</div>
                        <h4 class="text-2xl font-bold text-primary mb-2">${typeNames[type]}</h4>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">
                            Crie seu treino personalizado adicionando exerc√≠cios manualmente
                        </p>
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl p-4">
                            <p class="text-sm text-purple-700 dark:text-purple-300">
                                <i class="fas fa-lightbulb mr-2"></i>
                                Dica: Use exerc√≠cios variados para trabalhar diferentes √¢ngulos
                            </p>
                        </div>
                    </div>
                `;
                showNotification('info', 'Treino personalizado selecionado! Solte sua criatividade! üé®');
            }
        }

        // Enhanced current stats update
        function updateAdvancedCurrentStats() {
            const entries = document.querySelectorAll('.exercise-entry');
            let totalVolume = 0;
            let exerciseCount = 0;
            let estimatedCalories = 0;
            let muscleGroups = new Set();
            
            entries.forEach(entry => {
                const exerciseName = entry.querySelector('.exercise-name')?.value || entry.querySelector('.exercise-select')?.value;
                const sets = parseInt(entry.querySelector('.sets').value) || 0;
                const reps = parseInt(entry.querySelector('.reps').value) || 0;
                const weight = parseFloat(entry.querySelector('.weight').value) || 0;
                
                if (exerciseName && sets && reps) {
                    exerciseCount++;
                    totalVolume += (weight * sets * reps);
                    
                    // Find exercise in database for calorie calculation
                    const exerciseData = exerciseDatabase.find(ex => ex.name === exerciseName);
                    if (exerciseData) {
                        estimatedCalories += (sets * reps * exerciseData.caloriesPerRep);
                        muscleGroups.add(exerciseData.muscle);
                    }
                }
            });
            
            // Update displays with enhanced formatting
            document.getElementById('currentVolumeDisplay').textContent = `${totalVolume.toFixed(1)}kg`;
            document.getElementById('currentExerciseDisplay').textContent = `${exerciseCount} exerc√≠cio${exerciseCount !== 1 ? 's' : ''}`;
            
            // Update summary if elements exist
            if (document.getElementById('summaryExercises')) {
                updateEnhancedWorkoutSummary(exerciseCount, totalVolume, estimatedCalories, muscleGroups.size);
            }
        }

        function updateEnhancedWorkoutSummary(exerciseCount, totalVolume, estimatedCalories, muscleVariety) {
            const entries = document.querySelectorAll('.exercise-entry');
            let totalSets = 0;
            let totalReps = 0;
            
            entries.forEach(entry => {
                const sets = parseInt(entry.querySelector('.sets').value) || 0;
                const reps = parseInt(entry.querySelector('.reps').value) || 0;
                
                totalSets += sets;
                totalReps += (sets * reps);
            });
            
            // Update basic summary
            document.getElementById('summaryExercises').textContent = exerciseCount;
            document.getElementById('summarySets').textContent = totalSets;
            document.getElementById('summaryReps').textContent = totalReps;
            document.getElementById('summaryVolume').textContent = `${totalVolume.toFixed(1)}kg`;
            
            // Update enhanced metrics
            const avgSets = exerciseCount > 0 ? (totalSets / exerciseCount).toFixed(1) : 0;
            const avgReps = totalSets > 0 ? (totalReps / totalSets).toFixed(1) : 0;
            const estimatedTime = Math.round(totalSets * 2.5 + exerciseCount * 2);
            
            document.getElementById('exerciseVariety').textContent = `${muscleVariety} grupos musculares`;
            document.getElementById('avgSets').textContent = `${avgSets} por exerc√≠cio`;
            document.getElementById('avgReps').textContent = `${avgReps} por s√©rie`;
            document.getElementById('estimatedTime').textContent = `~${estimatedTime} min`;
            
            // Generate enhanced tips
            generateEnhancedWorkoutTips(exerciseCount, totalSets, totalVolume, muscleVariety, estimatedCalories);
        }

        function generateEnhancedWorkoutTips(exercises, sets, volume, muscleVariety, calories) {
            const tipElement = document.getElementById('tipText');
            if (!tipElement) return;
            
            let tips = [];
            
            if (exercises === 0) {
                tips.push('Adicione exerc√≠cios para receber dicas personalizadas da IA!');
            } else if (exercises < 3) {
                tips.push('üí° Considere adicionar mais exerc√≠cios para um treino mais completo e eficaz.');
            } else if (exercises > 8) {
                tips.push('‚ö†Ô∏è Muitos exerc√≠cios podem causar fadiga excessiva. Foque na qualidade da execu√ß√£o.');
            } else if (sets < 8) {
                tips.push('üìä Volume baixo detectado. Adicione mais s√©ries para maximizar os ganhos.');
            } else if (sets > 25) {
                tips.push('üî• Alto volume detectado! Certifique-se de ter energia e nutri√ß√£o adequadas.');
            } else if (muscleVariety === 1) {
                tips.push('üéØ Treino focado detectado! √ìtimo para especializa√ß√£o muscular.');
            } else if (muscleVariety >= 4) {
                tips.push('üåü Excelente variedade muscular! Treino bem balanceado para desenvolvimento completo.');
            } else {
                tips.push('‚úÖ Treino bem estruturado! Mantenha boa forma e controle em todos os exerc√≠cios.');
            }
            
            // Calorie-based tips
            if (calories > 300) {
                tips.push('üî• Alto gasto cal√≥rico! Hidrate-se bem e mantenha energia com carboidratos.');
            } else if (calories > 0 && calories < 150) {
                tips.push('üí™ Volume moderado. Considere aumentar a intensidade para maior gasto energ√©tico.');
            }
            
            // Volume-based tips
            if (volume > 3000) {
                tips.push('üèãÔ∏è‚Äç‚ôÇÔ∏è Volume impressionante! Priorize recupera√ß√£o e alimenta√ß√£o p√≥s-treino.');
            }
            
            // Variety-based tips
            if (muscleVariety >= 5) {
                tips.push('üé® Treino completo detectado! Trabalho equilibrado de m√∫ltiplos grupos musculares.');
            }
            
            // Random motivational tips
            const motivationalTips = [
                'üöÄ Lembre-se: consist√™ncia √© a chave para resultados duradouros!',
                'üíé Cada repeti√ß√£o te aproxima dos seus objetivos. Mantenha o foco!',
                '‚ö° A magia acontece quando voc√™ sai da sua zona de conforto!',
                'üéØ Visualize seus objetivos durante cada s√©rie para maior motiva√ß√£o!'
            ];
            
            if (tips.length === 0 || Math.random() < 0.3) {
                tips.push(motivationalTips[Math.floor(Math.random() * motivationalTips.length)]);
            }
            
            tipElement.textContent = tips[Math.floor(Math.random() * tips.length)];
        }

        // Enhanced exercise list with search and filters
        function populateEnhancedExerciseList() {
            const container = document.getElementById('exerciseList');
            const searchTerm = document.getElementById('exerciseSearch')?.value.toLowerCase() || '';
            const muscleFilter = document.getElementById('muscleFilter')?.value || '';
            const difficultyFilter = document.getElementById('difficultyFilter')?.value || '';
            
            let filteredExercises = exerciseDatabase;
            
            if (searchTerm) {
                filteredExercises = filteredExercises.filter(ex => 
                    ex.name.toLowerCase().includes(searchTerm) ||
                    ex.instructions.toLowerCase().includes(searchTerm)
                );
            }
            
            if (muscleFilter) {
                filteredExercises = filteredExercises.filter(ex => ex.muscle === muscleFilter);
            }
            
            if (difficultyFilter) {
                filteredExercises = filteredExercises.filter(ex => ex.difficulty === difficultyFilter);
            }
            
            container.innerHTML = '';
            
            filteredExercises.forEach((exercise, index) => {
                const difficultyColors = {
                    beginner: 'from-green-500 to-emerald-600',
                    intermediate: 'from-yellow-500 to-orange-500',
                    advanced: 'from-red-500 to-red-600'
                };
                
                const muscleIcons = {
                    peito: 'üí™',
                    costas: 'üî•',
                    ombros: 'üèÜ',
                    bra√ßos: 'üí•',
                    pernas: 'ü¶µ',
                    core: '‚ö°'
                };
                
                const card = document.createElement('div');
                card.className = 'bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 hover:shadow-2xl transition-all duration-300 cursor-pointer group hover:scale-105 animate-fade-in';
                card.style.animationDelay = `${index * 0.1}s`;
                
                card.innerHTML = `
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <div class="text-3xl">${muscleIcons[exercise.muscle]}</div>
                            <div>
                                <h3 class="text-xl font-bold group-hover:text-primary transition-colors">${exercise.name}</h3>
                                <p class="text-gray-500 dark:text-gray-400 capitalize">${exercise.muscle}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="bg-gradient-to-r ${difficultyColors[exercise.difficulty]} text-white px-3 py-1 rounded-full text-xs font-semibold capitalize">
                                ${exercise.difficulty}
                            </span>
                            <div class="text-xs text-gray-500 mt-1">${exercise.caloriesPerRep.toFixed(1)} kcal/rep</div>
                        </div>
                    </div>
                    
                    <p class="text-gray-600 dark:text-gray-400 text-sm mb-4 leading-relaxed">${exercise.instructions}</p>
                    
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900 dark:to-indigo-900 rounded-xl p-4 mb-4">
                        <p class="text-blue-800 dark:text-blue-200 text-sm">
                            <i class="fas fa-lightbulb mr-2"></i>
                            <strong>Dica:</strong> ${exercise.tips}
                        </p>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button class="add-to-workout bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-xl text-sm font-semibold transition-all" data-exercise="${exercise.name}">
                            <i class="fas fa-plus mr-2"></i>Adicionar ao Treino
                        </button>
                        <button class="text-gray-500 hover:text-primary transition-colors" onclick="showEnhancedExerciseModal('${exercise.name}')">
                            <i class="fas fa-info-circle mr-1"></i>Detalhes
                        </button>
                    </div>
                `;
                
                container.appendChild(card);
            });
            
            // Add event listeners for "Add to Workout" buttons
            container.querySelectorAll('.add-to-workout').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const exerciseName = this.dataset.exercise;
                    const exerciseData = exerciseDatabase.find(ex => ex.name === exerciseName);
                    
                    if (exerciseData) {
                        // Switch to workout tab and add exercise
                        switchTab('workout');
                        setTimeout(() => {
                            addExerciseFromTemplate({
                                exercise: exerciseName,
                                sets: 3,
                                reps: 12,
                                weight: 20
                            });
                            showNotification('success', `${exerciseName} adicionado ao treino! üí™`);
                        }, 500);
                    }
                });
            });
            
            // Setup search and filter listeners
            const searchInput = document.getElementById('exerciseSearch');
            const muscleSelect = document.getElementById('muscleFilter');
            const difficultySelect = document.getElementById('difficultyFilter');
            
            if (searchInput && !searchInput.hasAttribute('data-listener')) {
                searchInput.addEventListener('input', populateEnhancedExerciseList);
                searchInput.setAttribute('data-listener', 'true');
            }
            
            if (muscleSelect && !muscleSelect.hasAttribute('data-listener')) {
                muscleSelect.addEventListener('change', populateEnhancedExerciseList);
                muscleSelect.setAttribute('data-listener', 'true');
            }
            
            if (difficultySelect && !difficultySelect.hasAttribute('data-listener')) {
                difficultySelect.addEventListener('change', populateEnhancedExerciseList);
                difficultySelect.setAttribute('data-listener', 'true');
            }
        }

        // Enhanced dashboard
        function updateEnhancedDashboard() {
            console.log('üìä Atualizando dashboard avan√ßado...');
            
            // Calculate metrics
            const weeklyWorkouts = getWeeklyWorkouts();
            const totalVolume = getTotalVolume();
            const currentStreak = getCurrentStreak();
            const strengthScore = calculateStrengthScore();
            
            // Update displays
            document.getElementById('weeklyWorkouts').textContent = weeklyWorkouts;
            document.getElementById('totalVolume').textContent = totalVolume.toFixed(1);
            document.getElementById('currentStreak').textContent = currentStreak;
            document.getElementById('strengthScore').textContent = strengthScore;
            
            // Update header stats
            document.getElementById('headerLevel').textContent = `N√≠vel ${currentLevel}`;
            document.getElementById('headerStreak').textContent = currentStreak;
            
            // Update badges
            document.getElementById('dashboardBadge').textContent = workouts.length;
            
            // Calculate changes
            updateMetricChanges();
            
            // Update recent activities
            updateRecentWorkouts();
            updatePopularExercises();
            
            // Update AI insights
            generateAdvancedAIInsights();
            
            // Update level system
            updateLevelSystem();
            
            // Check achievements
            checkAndUpdateAchievements();
        }

        function updateMetricChanges() {
            const now = new Date();
            const lastWeek = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            
            const thisWeekWorkouts = workouts.filter(w => new Date(w.date) >= lastWeek).length;
            const prevWeekStart = new Date(lastWeek.getTime() - 7 * 24 * 60 * 60 * 1000);
            const prevWeekWorkouts = workouts.filter(w => {
                const date = new Date(w.date);
                return date >= prevWeekStart && date < lastWeek;
            }).length;
            
            const change = prevWeekWorkouts > 0 ? ((thisWeekWorkouts - prevWeekWorkouts) / prevWeekWorkouts * 100).toFixed(0) : 0;
            document.getElementById('weeklyChange').textContent = `${change >= 0 ? '+' : ''}${change}%`;
        }

        function calculateStrengthScore() {
            if (workouts.length === 0) return 0;
            
            const totalVolume = getTotalVolume();
            const avgVolume = totalVolume / workouts.length;
            const uniqueExercises = getUniqueExercises();
            
            // Complex algorithm considering multiple factors
            const baseScore = Math.min(avgVolume / 10, 100);
            const varietyBonus = Math.min(uniqueExercises * 2, 30);
            const consistencyBonus = Math.min(getCurrentStreak() * 3, 20);
            
            return Math.round(baseScore + varietyBonus + consistencyBonus);
        }

        function generateAdvancedAIInsights() {
            const container = document.getElementById('aiInsights');
            if (!container || workouts.length === 0) {
                container.innerHTML = `
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <p class="text-indigo-100">ü§ñ Registre alguns treinos para receber insights personalizados e recomenda√ß√µes baseadas em IA!</p>
                    </div>
                `;
                return;
            }
            
            const insights = [];
            
            // Advanced analytics
            const recentVolume = workouts.slice(-5).reduce((sum, w) => sum + w.totalWeight, 0) / Math.min(5, workouts.length);
            const avgVolume = getTotalVolume() / workouts.length;
            const weeklyFreq = getWeeklyWorkouts();
            const streak = getCurrentStreak();
            
            // Volume progression analysis
            if (recentVolume > avgVolume * 1.3) {
                insights.push({
                    type: 'success',
                    title: 'Progress√£o Excepcional',
                    text: 'Seu volume aumentou 30%+ recentemente! Continue essa intensidade.'
                });
            } else if (recentVolume < avgVolume * 0.7) {
                insights.push({
                    type: 'warning',
                    title: 'Volume em Decl√≠nio',
                    text: 'Volume 30% abaixo da m√©dia. Considere revisitar seus objetivos.'
                });
            }
            
            // Frequency analysis
            if (weeklyFreq >= 5) {
                insights.push({
                    type: 'info',
                    title: 'Alta Frequ√™ncia',
                    text: 'Frequ√™ncia excelente! Monitore sinais de overtraining.'
                });
            } else if (weeklyFreq < 3) {
                insights.push({
                    type: 'suggestion',
                    title: 'Aumente a Frequ√™ncia',
                    text: 'Para melhores resultados, tente 3-4 treinos semanais.'
                });
            }
            
            // Muscle balance analysis
            const muscleDistribution = analyzeMuscleBalance();
            if (muscleDistribution.imbalance > 50) {
                insights.push({
                    type: 'warning',
                    title: 'Desequil√≠brio Muscular',
                    text: `Muito foco em ${muscleDistribution.dominant}. Balance com outros grupos.`
                });
            }
            
            // Personalized recommendations
            if (workouts.length >= 10) {
                const recommendation = generatePersonalizedRecommendation();
                insights.push({
                    type: 'ai',
                    title: 'Recomenda√ß√£o IA',
                    text: recommendation
                });
            }
            
            // Default motivational insight
            if (insights.length === 0) {
                insights.push({
                    type: 'success',
                    title: 'Progresso Constante',
                    text: 'Voc√™ est√° no caminho certo! Consist√™ncia √© a chave do sucesso.'
                });
            }
            
            const colors = {
                success: 'from-green-500 to-emerald-600',
                warning: 'from-yellow-500 to-orange-500',
                info: 'from-blue-500 to-indigo-600',
                suggestion: 'from-purple-500 to-violet-600',
                ai: 'from-pink-500 to-rose-600'
            };
            
            container.innerHTML = insights.map(insight => `
                <div class="bg-gradient-to-r ${colors[insight.type]} bg-opacity-20 rounded-xl p-4 border border-white border-opacity-20">
                    <h4 class="font-bold text-white mb-2">${insight.title}</h4>
                    <p class="text-indigo-100 text-sm">${insight.text}</p>
                </div>
            `).join('');
        }

        function analyzeMuscleBalance() {
            const muscleCount = {};
            workouts.slice(-10).forEach(workout => {
                workout.exercises.forEach(exercise => {
                    const exerciseData = exerciseDatabase.find(ex => ex.name === exercise.exercise);
                    if (exerciseData) {
                        muscleCount[exerciseData.muscle] = (muscleCount[exerciseData.muscle] || 0) + 1;
                    }
                });
            });
            
            const total = Object.values(muscleCount).reduce((sum, count) => sum + count, 0);
            const percentages = Object.entries(muscleCount).map(([muscle, count]) => ({
                muscle,
                percentage: (count / total) * 100
            }));
            
            percentages.sort((a, b) => b.percentage - a.percentage);
            
            const dominant = percentages[0]?.muscle || 'nenhum';
            const imbalance = percentages[0]?.percentage || 0;
            
            return { dominant, imbalance };
        }

        function generatePersonalizedRecommendation() {
            const recommendations = [
                'Baseado no seu hist√≥rico, exerc√≠cios compostos como agachamento trar√£o mais ganhos.',
                'Sua progress√£o indica foco em hipertrofia. Considere 8-12 repeti√ß√µes por s√©rie.',
                'Dados sugerem que voc√™ responde bem a alto volume. Mantenha essa estrat√©gia.',
                'Padr√£o de treino indica potencial para periodiza√ß√£o. Varie intensidades semanalmente.',
                'An√°lise mostra boa consist√™ncia. Adicione exerc√≠cios unilaterais para corre√ß√£o de assimetrias.',
            ];
            
            return recommendations[Math.floor(Math.random() * recommendations.length)];
        }

        // Enhanced calculators
        function calculateAdvanced1RM() {
            const weight = parseFloat(document.getElementById('rmWeight').value);
            const reps = parseInt(document.getElementById('rmReps').value);
            
            if (!weight || !reps || reps < 1 || reps > 20) {
                showNotification('error', 'Por favor, insira valores v√°lidos (peso > 0 e repeti√ß√µes entre 1-20)');
                return;
            }
            
            // Brzycki formula: 1RM = weight √ó (36 / (37 - reps))
            const oneRM = weight * (36 / (37 - reps));
            
            // Calculate percentages
            const rm90 = oneRM * 0.9;
            const rm80 = oneRM * 0.8;
            const rm70 = oneRM * 0.7;
            
            document.getElementById('rmValue').textContent = `${oneRM.toFixed(1)}kg`;
            document.getElementById('rm90').textContent = rm90.toFixed(1);
            document.getElementById('rm80').textContent = rm80.toFixed(1);
            document.getElementById('rm70').textContent = rm70.toFixed(1);
            document.getElementById('rmResult').classList.remove('hidden');
            
            showNotification('success', 'C√°lculo de 1RM realizado com sucesso! üèãÔ∏è‚Äç‚ôÇÔ∏è');
        }

        function calculateAdvancedBMI() {
            const weight = parseFloat(document.getElementById('bmiWeight').value);
            const height = parseFloat(document.getElementById('bmiHeight').value);
            
            if (!weight || !height || weight <= 0 || height <= 0) {
                showNotification('error', 'Por favor, insira valores v√°lidos para peso e altura');
                return;
            }
            
            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);
            
            let category, color, bgColor;
            if (bmi < 18.5) {
                category = 'Abaixo do peso';
                color = 'text-blue-600 dark:text-blue-400';
                bgColor = 'bg-blue-50 dark:bg-blue-900';
            } else if (bmi < 25) {
                category = 'Peso normal';
                color = 'text-green-600 dark:text-green-400';
                bgColor = 'bg-green-50 dark:bg-green-900';
            } else if (bmi < 30) {
                category = 'Sobrepeso';
                color = 'text-yellow-600 dark:text-yellow-400';
                bgColor = 'bg-yellow-50 dark:bg-yellow-900';
            } else {
                category = 'Obesidade';
                color = 'text-red-600 dark:text-red-400';
                bgColor = 'bg-red-50 dark:bg-red-900';
            }
            
            document.getElementById('bmiValue').textContent = bmi.toFixed(1);
            document.getElementById('bmiValue').className = `text-4xl font-black mb-2 ${color}`;
            document.getElementById('bmiCategory').textContent = category;
            document.getElementById('bmiCategory').className = `text-lg font-semibold ${color}`;
            
            const resultDiv = document.getElementById('bmiResult');
            resultDiv.className = `p-6 ${bgColor} rounded-xl border-l-4 border-${color.includes('blue') ? 'blue' : color.includes('green') ? 'green' : color.includes('yellow') ? 'yellow' : 'red'}-500`;
            resultDiv.classList.remove('hidden');
            
            showNotification('success', 'C√°lculo de IMC realizado com sucesso! üìä');
        }

        // Initialize achievements
        function initializeAchievements() {
            achievements = achievementDefinitions.map(def => ({
                ...def,
                unlocked: false,
                unlockedDate: null
            }));
        }

        function checkAndUpdateAchievements() {
            let newAchievements = 0;
            
            achievements.forEach(achievement => {
                if (!achievement.unlocked && achievement.condition()) {
                    achievement.unlocked = true;
                    achievement.unlockedDate = new Date();
                    currentXP += achievement.xp;
                    newAchievements++;
                    
                    showAchievementUnlocked(achievement);
                }
            });
            
            if (newAchievements > 0) {
                updateLevelSystem();
                displayAchievements();
            }
        }

        function showAchievementUnlocked(achievement) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in';
            modal.innerHTML = `
                <div class="bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4 text-center text-white transform animate-scale-in">
                    <div class="text-8xl mb-4 animate-bounce">${achievement.icon}</div>
                    <h3 class="text-3xl font-black mb-2">üéâ CONQUISTA DESBLOQUEADA!</h3>
                    <h4 class="text-2xl font-bold mb-3">${achievement.name}</h4>
                    <p class="mb-4 text-lg opacity-90">${achievement.description}</p>
                    <div class="bg-white bg-opacity-20 rounded-xl p-3 mb-4">
                        <p class="text-sm">+${achievement.xp} XP</p>
                    </div>
                    <button class="bg-white text-orange-500 px-8 py-3 rounded-xl font-bold hover:bg-gray-100 transition-colors" onclick="this.closest('.fixed').remove()">
                        Incr√≠vel! üöÄ
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => {
                if (document.body.contains(modal)) {
                    modal.remove();
                }
            }, 8000);
        }

        function updateLevelSystem() {
            // Calculate level based on XP
            let newLevel = 1;
            for (let i = levelThresholds.length - 1; i >= 0; i--) {
                if (currentXP >= levelThresholds[i]) {
                    newLevel = i + 1;
                    break;
                }
            }
            
            if (newLevel > currentLevel) {
                showLevelUp(newLevel);
            }
            
            currentLevel = newLevel;
            
            // Update level displays
            const levelName = levelNames[currentLevel - 1] || 'Imortal';
            document.getElementById('currentLevel').textContent = newLevel;
            document.getElementById('currentLevelName').textContent = levelName;
            document.getElementById('currentXP').textContent = currentXP;
            
            const nextLevelXP = levelThresholds[currentLevel] || levelThresholds[levelThresholds.length - 1];
            document.getElementById('nextLevelXP').textContent = nextLevelXP;
            
            const progress = currentLevel >= levelThresholds.length ? 100 : 
                ((currentXP - levelThresholds[currentLevel - 1]) / (nextLevelXP - levelThresholds[currentLevel - 1])) * 100;
            
            document.getElementById('xpProgress').style.width = `${Math.min(progress, 100)}%`;
            
            // Update progress tab
            updateProgressTab();
        }

        function showLevelUp(newLevel) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 animate-fade-in';
            modal.innerHTML = `
                <div class="bg-gradient-to-r from-purple-600 via-blue-600 to-green-600 p-10 rounded-3xl shadow-2xl max-w-lg w-full mx-4 text-center text-white transform animate-scale-in">
                    <div class="text-9xl mb-6 animate-pulse">üéâ</div>
                    <h3 class="text-4xl font-black mb-4">LEVEL UP!</h3>
                    <div class="text-8xl font-black mb-4">${newLevel}</div>
                    <h4 class="text-2xl font-bold mb-4">${levelNames[newLevel - 1] || 'Imortal'}</h4>
                    <p class="mb-6 text-lg opacity-90">Voc√™ atingiu um novo patamar de excel√™ncia!</p>
                    <div class="bg-white bg-opacity-20 rounded-xl p-4 mb-6">
                        <p class="text-sm">Benef√≠cios desbloqueados:</p>
                        <p class="font-semibold">‚Ä¢ Novos exerc√≠cios dispon√≠veis</p>
                        <p class="font-semibold">‚Ä¢ Templates avan√ßados</p>
                        <p class="font-semibold">‚Ä¢ Insights premium da IA</p>
                    </div>
                    <button class="bg-white text-purple-600 px-10 py-4 rounded-xl font-bold hover:bg-gray-100 transition-colors text-lg" onclick="this.closest('.fixed').remove()">
                        Continuar Evoluindo! üöÄ
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => {
                if (document.body.contains(modal)) {
                    modal.remove();
                }
            }, 10000);
        }

        function updateProgressTab() {
            document.getElementById('totalWorkoutsLevel').textContent = workouts.length;
            document.getElementById('totalVolumeLevel').textContent = `${getTotalVolume().toFixed(1)}kg`;
            document.getElementById('bestStreakLevel').textContent = getBestStreak();
        }

        function displayAchievements() {
            const container = document.getElementById('achievementsGrid');
            if (!container) return;
            
            const unlockedAchievements = achievements.filter(a => a.unlocked);
            const lockedAchievements = achievements.filter(a => !a.unlocked);
            
            container.innerHTML = '';
            
            // Show unlocked achievements first
            unlockedAchievements.forEach(achievement => {
                const achievementEl = document.createElement('div');
                achievementEl.className = 'bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-6 text-white transform hover:scale-105 transition-all animate-fade-in shadow-xl';
                achievementEl.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <div class="text-4xl animate-bounce-slow">${achievement.icon}</div>
                        <div class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-xs font-semibold">
                            +${achievement.xp} XP
                        </div>
                    </div>
                    <h4 class="font-bold text-lg mb-2">${achievement.name}</h4>
                    <p class="text-sm opacity-90 mb-3">${achievement.description}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-white bg-opacity-20 px-2 py-1 rounded">‚úì Desbloqueado</span>
                        ${achievement.unlockedDate ? `<span class="text-xs opacity-75">${new Date(achievement.unlockedDate).toLocaleDateString('pt-BR')}</span>` : ''}
                    </div>
                `;
                container.appendChild(achievementEl);
            });
            
            // Show locked achievements
            lockedAchievements.slice(0, 6).forEach(achievement => {
                const achievementEl = document.createElement('div');
                achievementEl.className = 'bg-gray-200 dark:bg-gray-700 rounded-2xl p-6 opacity-60 hover:opacity-80 transition-opacity shadow-lg';
                achievementEl.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <div class="text-4xl grayscale">üîí</div>
                        <div class="bg-gray-300 dark:bg-gray-600 px-3 py-1 rounded-full text-xs font-semibold">
                            ${achievement.xp} XP
                        </div>
                    </div>
                    <h4 class="font-bold text-lg mb-2 text-gray-600 dark:text-gray-400">${achievement.name}</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-500 mb-3">${achievement.description}</p>
                    <span class="text-xs bg-gray-300 dark:bg-gray-600 px-2 py-1 rounded">üîí Bloqueado</span>
                `;
                container.appendChild(achievementEl);
            });
        }

        // Goal system
        function createGoal(e) {
            e.preventDefault();
            
            const type = document.getElementById('goalType').value;
            const target = parseInt(document.getElementById('goalTarget').value);
            const period = document.getElementById('goalPeriod').value;
            
            if (!target || target <= 0) {
                showNotification('error', 'Por favor, insira um valor v√°lido para a meta');
                return;
            }
            
            const goal = {
                id: Date.now(),
                type,
                target,
                period,
                createdDate: new Date(),
                progress: 0
            };
            
            goals.push(goal);
            updateGoalDisplay();
            document.getElementById('goalForm').reset();
            
            showNotification('success', 'Meta criada com sucesso! üéØ');
        }

        function updateGoalDisplay() {
            // Implementation for goal display updates
            console.log('Updating goals display...');
        }

        // Utility functions
        function getWeeklyWorkouts() {
            const now = new Date();
            const weekStart = new Date(now.setDate(now.getDate() - now.getDay()));
            return workouts.filter(w => new Date(w.date) >= weekStart).length;
        }

        function getCurrentStreak() {
            if (workouts.length === 0) return 0;
            
            const sortedDates = workouts.map(w => new Date(w.date)).sort((a, b) => b - a);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            let streak = 0;
            let currentDate = new Date(today);
            
            for (let workoutDate of sortedDates) {
                workoutDate.setHours(0, 0, 0, 0);
                
                if (workoutDate.getTime() === currentDate.getTime()) {
                    streak++;
                    currentDate.setDate(currentDate.getDate() - 1);
                } else if (workoutDate.getTime() < currentDate.getTime()) {
                    break;
                }
            }
            
            return streak;
        }

        function getBestStreak() {
            if (workouts.length === 0) return 0;
            
            const sortedDates = workouts.map(w => new Date(w.date)).sort((a, b) => a - b);
            let maxStreak = 0;
            let currentStreak = 1;
            
            for (let i = 1; i < sortedDates.length; i++) {
                const prevDate = new Date(sortedDates[i - 1]);
                const currentDate = new Date(sortedDates[i]);
                const diffDays = (currentDate - prevDate) / (1000 * 60 * 60 * 24);
                
                if (diffDays === 1) {
                    currentStreak++;
                } else {
                    maxStreak = Math.max(maxStreak, currentStreak);
                    currentStreak = 1;
                }
            }
            
            return Math.max(maxStreak, currentStreak);
        }

        function getTotalVolume() {
            return workouts.reduce((sum, w) => sum + w.totalWeight, 0);
        }

        function getUniqueExercises() {
            const unique = new Set();
            workouts.forEach(w => {
                w.exercises.forEach(e => unique.add(e.exercise));
            });
            return unique.size;
        }

        function getTotalTime() {
            return workouts.reduce((sum, w) => sum + w.duration, 0);
        }

        // Enhanced form submission
        function handleAdvancedFormSubmit(e) {
            e.preventDefault();
            console.log('üíæ Salvando treino avan√ßado...');
            
            const date = document.getElementById('workoutDate').value;
            if (!date) {
                showNotification('error', 'Por favor, selecione uma data para o treino!');
                return;
            }
            
            const exercises = [];
            const entries = document.querySelectorAll('.exercise-entry');
            
            entries.forEach(entry => {
                const exerciseName = entry.querySelector('.exercise-name')?.value || entry.querySelector('.exercise-select')?.value;
                const sets = parseInt(entry.querySelector('.sets').value) || 0;
                const reps = parseInt(entry.querySelector('.reps').value) || 0;
                const weight = parseFloat(entry.querySelector('.weight').value) || 0;
                
                if (exerciseName && sets > 0 && reps > 0) {
                    exercises.push({ exercise: exerciseName, sets, reps, weight });
                }
            });
            
            if (exercises.length === 0) {
                showNotification('error', 'Adicione pelo menos um exerc√≠cio ao treino!');
                return;
            }
            
            let duration = 30; // Default duration
            const durationDisplay = document.getElementById('workoutDurationDisplay').value;
            if (durationDisplay && durationDisplay.includes('minutos')) {
                duration = parseInt(durationDisplay.split(' ')[0]);
            }
            
            const workout = {
                id: Date.now(),
                date,
                duration,
                startTime: workoutStartTime ? workoutStartTime.toISOString() : new Date().toISOString(),
                exercises,
                totalWeight: exercises.reduce((sum, ex) => sum + (ex.weight * ex.sets * ex.reps), 0),
                type: selectedWorkoutType,
                intensity: document.getElementById('workoutIntensitySelect').value,
                notes: document.getElementById('workoutNotes')?.value || ''
            };
            
            workouts.push(workout);
            
            // Add XP for completing workout
            const xpGain = calculateWorkoutXP(workout);
            currentXP += xpGain;
            
            console.log('‚úÖ Treino avan√ßado salvo:', workout);
            
            showNotification('success', `Treino salvo! +${xpGain} XP conquistados! üèÜ`);
            clearForm();
            updateEnhancedDashboard();
            updateWorkoutHistory();
            
            // Reset workout timer state if needed
            if (isWorkoutRunning) {
                stopWorkout();
            }
        }

        function calculateWorkoutXP(workout) {
            let baseXP = 20; // Base XP for any workout
            
            // Bonus for exercise variety
            baseXP += workout.exercises.length * 5;
            
            // Bonus for volume
            baseXP += Math.floor(workout.totalWeight / 100) * 10;
            
            // Bonus for duration
            if (workout.duration >= 45) baseXP += 15;
            else if (workout.duration >= 30) baseXP += 10;
            
            // Bonus for intensity
            const intensityBonuses = {
                low: 0,
                moderate: 5,
                high: 10,
                extreme: 20
            };
            baseXP += intensityBonuses[workout.intensity] || 0;
            
            return baseXP;
        }

        // Enhanced history export
        function exportHistory() {
            const data = {
                workouts: workouts,
                achievements: achievements,
                currentLevel: currentLevel,
                currentXP: currentXP,
                goals: goals,
                exportDate: new Date().toISOString(),
                version: '2.0'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fittracker-pro-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('success', 'Dados exportados com sucesso! üì•');
        }

        // Quick timer functions (keeping existing functionality)
        function toggleQuickTimer() {
            if (isQuickTimerRunning) {
                pauseQuickTimer();
            } else {
                if (quickTimerSeconds === 0) {
                    quickTimerSeconds = 60;
                }
                startQuickTimerCountdown();
            }
        }

        function startQuickTimer(seconds) {
            resetQuickTimer();
            quickTimerSeconds = seconds;
            updateQuickTimerDisplay();
            startQuickTimerCountdown();
        }

        function startQuickTimerCountdown() {
            isQuickTimerRunning = true;
            document.getElementById('quickStartBtn').innerHTML = '<i class="fas fa-pause mr-2"></i>Pausar';
            
            quickTimer = setInterval(() => {
                quickTimerSeconds--;
                updateQuickTimerDisplay();
                
                if (quickTimerSeconds <= 0) {
                    resetQuickTimer();
                    showNotification('success', '‚è∞ Descanso finalizado! Pr√≥xima s√©rie!');
                }
            }, 1000);
        }

        function pauseQuickTimer() {
            isQuickTimerRunning = false;
            clearInterval(quickTimer);
            document.getElementById('quickStartBtn').innerHTML = '<i class="fas fa-play mr-2"></i>Retomar';
        }

        function resetQuickTimer() {
            isQuickTimerRunning = false;
            clearInterval(quickTimer);
            quickTimerSeconds = 0;
            updateQuickTimerDisplay();
            document.getElementById('quickStartBtn').innerHTML = '<i class="fas fa-clock mr-2"></i>Timer';
        }

        function updateQuickTimerDisplay() {
            const minutes = Math.floor(quickTimerSeconds / 60);
            const seconds = quickTimerSeconds % 60;
            document.getElementById('quickTimer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // Rest timer functions (enhanced)
        function toggleRestTimer() {
            if (isRestTimerRunning) {
                pauseRestTimer();
            } else {
                if (restTimerSeconds === 0) {
                    restTimerSeconds = 120;
                }
                startRestTimer();
            }
        }

        function setRestTimer(seconds) {
            resetRestTimer();
            restTimerSeconds = seconds;
            updateRestTimerDisplay();
            startRestTimer();
        }

        function startRestTimer() {
            isRestTimerRunning = true;
            document.getElementById('timerBtn').innerHTML = '<i class="fas fa-pause mr-2"></i>Pausar';
            
            restTimer = setInterval(() => {
                restTimerSeconds--;
                updateRestTimerDisplay();
                
                if (restTimerSeconds <= 0) {
                    resetRestTimer();
                    showNotification('success', 'üîî Tempo de descanso finalizado! Pr√≥ximo exerc√≠cio!');
                }
            }, 1000);
        }

        function pauseRestTimer() {
            isRestTimerRunning = false;
            clearInterval(restTimer);
            document.getElementById('timerBtn').innerHTML = '<i class="fas fa-play mr-2"></i>Retomar';
        }

        function resetRestTimer() {
            isRestTimerRunning = false;
            clearInterval(restTimer);
            restTimerSeconds = 0;
            updateRestTimerDisplay();
            document.getElementById('timerBtn').innerHTML = '<i class="fas fa-play mr-2"></i>Iniciar';
        }

        function updateRestTimerDisplay() {
            const minutes = Math.floor(restTimerSeconds / 60);
            const seconds = restTimerSeconds % 60;
            document.getElementById('timerDisplay').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // Standard workout functions (enhanced versions)
        function pauseWorkout() {
            if (isWorkoutRunning && !isWorkoutPaused) {
                isWorkoutPaused = true;
                clearInterval(workoutTimer);
                
                document.getElementById('statusText').textContent = 'Treino pausado - Hidrate-se e descanse! üíß';
                document.getElementById('workoutIntensity').textContent = 'Pausado';
                document.getElementById('pauseWorkoutBtn').classList.add('hidden');
                document.getElementById('resumeWorkoutBtn').classList.remove('hidden');
                
                showNotification('info', 'Treino pausado. Aproveite para se hidratar! üíß');
            }
        }

        function resumeWorkout() {
            if (isWorkoutRunning && isWorkoutPaused) {
                isWorkoutPaused = false;
                
                document.getElementById('statusText').textContent = 'Treino retomado... Vamos com tudo! üöÄ';
                document.getElementById('workoutIntensity').textContent = 'Em andamento';
                document.getElementById('resumeWorkoutBtn').classList.add('hidden');
                document.getElementById('pauseWorkoutBtn').classList.remove('hidden');
                
                workoutTimer = setInterval(updateAdvancedWorkoutTimer, 1000);
                
                showNotification('success', 'Treino retomado! Vamos conquistar! üöÄ');
            }
        }

        function stopWorkout() {
            if (isWorkoutRunning) {
                const totalMinutes = Math.round(workoutElapsedTime / 60);
                
                document.getElementById('workoutDurationDisplay').value = `${totalMinutes} minutos`;
                document.getElementById('statusText').innerHTML = `
                    <span class="text-green-400 font-bold">Treino finalizado com sucesso!</span><br>
                    Dura√ß√£o: ${totalMinutes} min ‚Ä¢ Excelente trabalho! üéâ
                `;
                document.getElementById('workoutIntensity').textContent = 'Finalizado';
                
                document.getElementById('liveTimer').textContent = '00:00:00';
                
                document.getElementById('startWorkoutBtn').classList.remove('hidden');
                document.getElementById('pauseWorkoutBtn').classList.add('hidden');
                document.getElementById('resumeWorkoutBtn').classList.add('hidden');
                document.getElementById('stopWorkoutBtn').classList.add('hidden');
                
                clearInterval(workoutTimer);
                
                isWorkoutRunning = false;
                isWorkoutPaused = false;
                
                showNotification('success', `Parab√©ns! Treino de ${totalMinutes} minutos conclu√≠do! üéâ`);
            }
        }

        // Enhanced tab switching
        function switchTab(targetTab) {
            // Update active button
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active', 'border-primary', 'text-primary');
                btn.classList.add('border-transparent');
            });
            document.querySelector(`[data-tab="${targetTab}"]`).classList.add('active', 'border-primary', 'text-primary');
            document.querySelector(`[data-tab="${targetTab}"]`).classList.remove('border-transparent');
            
            // Show target tab
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            document.getElementById(targetTab).classList.remove('hidden');
            
            // Tab-specific actions
            if (targetTab === 'dashboard') {
                updateEnhancedDashboard();
            } else if (targetTab === 'exercises') {
                populateEnhancedExerciseList();
            } else if (targetTab === 'progress') {
                displayAchievements();
                updateProgressTab();
            }
        }

        // Exercise management functions (enhanced)
        function addExercise() {
            exerciseIndex++;
            const container = document.getElementById('exerciseEntries');
            
            const exerciseEntry = document.createElement('div');
            exerciseEntry.className = 'exercise-entry bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-2xl animate-fade-in border-2 border-transparent hover:border-primary transition-all shadow-lg';
            exerciseEntry.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <span class="font-bold text-lg text-primary">Exerc√≠cio ${exerciseIndex}</span>
                    <button type="button" class="remove-exercise bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-all">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Exerc√≠cio</label>
                        <select class="exercise-select w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all">
                            <option value="">Selecione...</option>
                            ${exerciseDatabase.map(ex => `<option value="${ex.name}">${ex.name}</option>`).join('')}
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">S√©ries</label>
                        <input type="number" class="sets w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all" min="1" placeholder="3">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Repeti√ß√µes</label>
                        <input type="number" class="reps w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all" min="1" placeholder="12">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Peso (kg)</label>
                        <input type="number" class="weight w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all" min="0" step="0.5" placeholder="20">
                    </div>
                </div>
            `;
            
            container.appendChild(exerciseEntry);
            
            // Add remove event listener
            exerciseEntry.querySelector('.remove-exercise').addEventListener('click', function() {
                exerciseEntry.remove();
                updateExerciseEmptyState();
                updateAdvancedCurrentStats();
            });
            
            // Add change listeners for live stats
            exerciseEntry.querySelectorAll('input, select').forEach(input => {
                input.addEventListener('input', updateAdvancedCurrentStats);
            });
            
            updateExerciseEmptyState();
            updateAdvancedCurrentStats();
            
            showNotification('success', 'Exerc√≠cio adicionado! üí™');
        }

        function addExerciseFromTemplate(exerciseData) {
            exerciseIndex++;
            const container = document.getElementById('exerciseEntries');
            
            const exerciseEntry = document.createElement('div');
            exerciseEntry.className = 'exercise-entry bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900 dark:to-indigo-900 p-6 rounded-2xl animate-fade-in border-2 border-primary shadow-xl';
            exerciseEntry.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center space-x-3">
                        <div class="bg-primary text-white p-2 rounded-full">
                            <i class="fas fa-star text-sm"></i>
                        </div>
                        <span class="font-bold text-lg text-primary">${exerciseData.exercise}</span>
                        <span class="bg-primary text-white px-2 py-1 rounded-full text-xs">Recomendado</span>
                    </div>
                    <button type="button" class="remove-exercise bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-all">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">S√©ries</label>
                        <input type="number" class="sets w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all" min="1" value="${exerciseData.sets}">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Repeti√ß√µes</label>
                        <input type="number" class="reps w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all" min="1" value="${exerciseData.reps}">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Peso (kg)</label>
                        <input type="number" class="weight w-full px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-primary bg-white dark:bg-gray-700 transition-all" min="0" step="0.5" value="${exerciseData.weight}">
                    </div>
                </div>
                <input type="hidden" class="exercise-name" value="${exerciseData.exercise}">
            `;
            
            container.appendChild(exerciseEntry);
            
            // Add remove event listener
            exerciseEntry.querySelector('.remove-exercise').addEventListener('click', function() {
                exerciseEntry.remove();
                updateExerciseEmptyState();
                updateAdvancedCurrentStats();
            });
            
            // Add change listeners for live stats
            exerciseEntry.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', updateAdvancedCurrentStats);
            });
        }

        function clearExercises() {
            document.getElementById('exerciseEntries').innerHTML = '';
            exerciseIndex = 0;
            updateExerciseEmptyState();
            updateAdvancedCurrentStats();
        }

        function updateExerciseEmptyState() {
            const entries = document.querySelectorAll('.exercise-entry');
            const emptyState = document.getElementById('exerciseEmptyState');
            
            if (entries.length === 0) {
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
            }
        }

        function clearForm() {
            document.getElementById('workoutForm').reset();
            document.getElementById('workoutDate').value = new Date().toISOString().split('T')[0];
            clearExercises();
            selectedWorkoutType = null;
            
            // Reset workout type selection
            document.querySelectorAll('.workout-type-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-white', 'ring-opacity-50', 'scale-110', 'transform');
            });
            
            document.getElementById('selectedWorkoutType').innerHTML = `
                <div class="text-center animate-fade-in">
                    <div class="text-6xl mb-4">‚ú®</div>
                    <p class="text-xl font-semibold text-gray-600 dark:text-gray-300">Selecione um tipo de treino acima</p>
                    <p class="text-gray-500 dark:text-gray-400 mt-2">Os exerc√≠cios ser√£o carregados automaticamente com configura√ß√µes otimizadas!</p>
                </div>
            `;
            document.getElementById('workoutFormContainer').style.display = 'none';
            
            showNotification('success', 'Formul√°rio limpo! Pronto para novo treino! ‚ú®');
        }

        // History functions
        function updateRecentWorkouts() {
            const container = document.getElementById('recentWorkouts');
            const recentWorkouts = workouts.slice(-5).reverse();
            
            if (recentWorkouts.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-dumbbell text-6xl text-gray-300 dark:text-gray-600 mb-4"></i>
                        <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum treino registrado ainda</p>
                        <p class="text-gray-400 dark:text-gray-500 text-sm">Comece seu primeiro treino para ver o progresso aqui!</p>
                    </div>
                `;
            } else {
                container.innerHTML = recentWorkouts.map(workout => {
                    const intensityColors = {
                        low: 'text-green-500',
                        moderate: 'text-yellow-500',
                        high: 'text-orange-500',
                        extreme: 'text-red-500'
                    };
                    
                    return `
                        <div class="flex justify-between items-center p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-xl hover:from-gray-100 hover:to-gray-200 dark:hover:from-gray-600 dark:hover:to-gray-500 transition-all cursor-pointer group">
                            <div>
                                <p class="font-semibold group-hover:text-primary transition-colors">${new Date(workout.date).toLocaleDateString('pt-BR')}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${workout.exercises.length} exerc√≠cios ‚Ä¢ ${workout.duration}min</p>
                                <p class="text-xs ${intensityColors[workout.intensity]} capitalize">${workout.intensity} intensidade</p>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-primary text-lg">${workout.totalWeight.toFixed(1)}kg</p>
                                <p class="text-xs text-gray-500">Volume total</p>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function updatePopularExercises() {
            const exerciseCount = {};
            workouts.forEach(w => {
                w.exercises.forEach(e => {
                    exerciseCount[e.exercise] = (exerciseCount[e.exercise] || 0) + 1;
                });
            });
            
            const container = document.getElementById('popularExercises');
            const sortedExercises = Object.entries(exerciseCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            if (sortedExercises.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-heart text-6xl text-gray-300 dark:text-gray-600 mb-4"></i>
                        <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum exerc√≠cio registrado ainda</p>
                        <p class="text-gray-400 dark:text-gray-500 text-sm">Seus exerc√≠cios mais praticados aparecer√£o aqui!</p>
                    </div>
                `;
            } else {
                container.innerHTML = sortedExercises.map(([exercise, count]) => {
                    const exerciseData = exerciseDatabase.find(ex => ex.name === exercise);
                    const muscleIcons = {
                        peito: 'üí™',
                        costas: 'üî•',
                        ombros: 'üèÜ',
                        bra√ßos: 'üí•',
                        pernas: 'ü¶µ',
                        core: '‚ö°'
                    };
                    
                    return `
                        <div class="flex justify-between items-center p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-xl hover:from-gray-100 hover:to-gray-200 dark:hover:from-gray-600 dark:hover:to-gray-500 transition-all cursor-pointer group">
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">${exerciseData ? muscleIcons[exerciseData.muscle] : 'üèãÔ∏è'}</div>
                                <div>
                                    <p class="font-semibold group-hover:text-primary transition-colors">${exercise}</p>
                                    <p class="text-xs text-gray-500 capitalize">${exerciseData ? exerciseData.muscle : 'exerc√≠cio'}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="bg-primary text-white px-3 py-1 rounded-full text-sm font-semibold">${count}x</span>
                                <i class="fas fa-star text-yellow-500"></i>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function updateWorkoutHistory() {
            const container = document.getElementById('workoutHistory');
            
            if (workouts.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-16">
                        <i class="fas fa-history text-8xl text-gray-300 dark:text-gray-600 mb-6"></i>
                        <h3 class="text-2xl font-bold text-gray-500 dark:text-gray-400 mb-2">Nenhum treino registrado ainda</h3>
                        <p class="text-gray-400 dark:text-gray-500">Seus treinos aparecer√£o aqui ap√≥s serem salvos!</p>
                    </div>
                `;
                return;
            }
            
            const sortedWorkouts = workouts.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            container.innerHTML = sortedWorkouts.map(workout => {
                const intensityColors = {
                    low: 'from-green-500 to-emerald-600',
                    moderate: 'from-yellow-500 to-orange-500',
                    high: 'from-orange-500 to-red-500',
                    extreme: 'from-red-500 to-red-600'
                };
                
                return `
                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 hover:shadow-2xl transition-all animate-fade-in">
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <h3 class="text-2xl font-bold mb-2">${new Date(workout.date).toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</h3>
                                <div class="flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400">
                                    <span><i class="fas fa-clock mr-1"></i>${workout.duration} min</span>
                                    <span class="bg-gradient-to-r ${intensityColors[workout.intensity]} text-white px-3 py-1 rounded-full text-xs font-semibold capitalize">${workout.intensity}</span>
                                    ${workout.type ? `<span class="bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs">${workout.type}</span>` : ''}
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-black text-primary mb-1">${workout.totalWeight.toFixed(1)}kg</p>
                                <p class="text-sm text-gray-500">Volume total</p>
                                <button class="delete-workout text-red-500 hover:text-red-700 text-sm mt-2 hover:bg-red-50 dark:hover:bg-red-900 px-2 py-1 rounded transition-all" data-id="${workout.id}">
                                    <i class="fas fa-trash mr-1"></i>Excluir
                                </button>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                            ${workout.exercises.map(exercise => {
                                const exerciseData = exerciseDatabase.find(ex => ex.name === exercise.exercise);
                                const muscleIcons = {
                                    peito: 'üí™',
                                    costas: 'üî•',
                                    ombros: 'üèÜ',
                                    bra√ßos: 'üí•',
                                    pernas: 'ü¶µ',
                                    core: '‚ö°'
                                };
                                
                                return `
                                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors">
                                        <div class="flex items-center space-x-2 mb-2">
                                            <span class="text-lg">${exerciseData ? muscleIcons[exerciseData.muscle] : 'üèãÔ∏è'}</span>
                                            <h4 class="font-semibold">${exercise.exercise}</h4>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">
                                            ${exercise.sets} s√©ries √ó ${exercise.reps} reps
                                            ${exercise.weight > 0 ? ` @ ${exercise.weight}kg` : ''}
                                        </p>
                                        <p class="text-xs text-primary font-semibold">
                                            Volume: ${(exercise.weight * exercise.sets * exercise.reps).toFixed(1)}kg
                                        </p>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        
                        ${workout.notes ? `
                            <div class="bg-blue-50 dark:bg-blue-900 rounded-xl p-4 border-l-4 border-blue-500">
                                <p class="text-blue-800 dark:text-blue-200 text-sm">
                                    <i class="fas fa-sticky-note mr-2"></i>
                                    <strong>Notas:</strong> ${workout.notes}
                                </p>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            // Add delete event listeners
            container.querySelectorAll('.delete-workout').forEach(btn => {
                btn.addEventListener('click', function() {
                    const workoutId = parseInt(this.dataset.id);
                    deleteWorkout(workoutId);
                });
            });
        }

        function deleteWorkout(workoutId) {
            showConfirmDialog('Tem certeza que deseja excluir este treino?', () => {
                workouts = workouts.filter(w => w.id !== workoutId);
                updateWorkoutHistory();
                updateEnhancedDashboard();
                showNotification('success', 'Treino exclu√≠do com sucesso!');
            });
        }

        function clearHistory() {
            if (workouts.length === 0) {
                showNotification('warning', 'N√£o h√° treinos para excluir.');
                return;
            }
            
            showConfirmDialog('Tem certeza que deseja excluir TODOS os treinos?', () => {
                workouts = [];
                updateWorkoutHistory();
                updateEnhancedDashboard();
                showNotification('success', 'Hist√≥rico limpo com sucesso!');
            });
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4 animate-scale-in">
                    <div class="text-center mb-6">
                        <i class="fas fa-exclamation-triangle text-6xl text-yellow-500 mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Confirma√ß√£o</h3>
                        <p class="text-gray-600 dark:text-gray-400">${message}</p>
                    </div>
                    <div class="flex space-x-4">
                        <button class="flex-1 px-6 py-3 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all" onclick="this.closest('.fixed').remove()">
                            Cancelar
                        </button>
                        <button class="flex-1 px-6 py-3 bg-red-500 text-white hover:bg-red-600 rounded-xl transition-all font-semibold" onclick="this.closest('.fixed').remove(); (${onConfirm})()">
                            Confirmar
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize empty states
        updateExerciseEmptyState();
        
        console.log('üéâ FitTracker Pro inicializado com recursos avan√ßados!');
    </script>
</body>
</html>
